
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>API Reference: Files &#8212; Hyperscan 5.4.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/hyperscan.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Chimera" href="chimera.html" />
    <link rel="prev" title="API Reference: Constants" href="api_constants.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api-reference-files">
<span id="api-files"></span><h1>API Reference: Files<a class="headerlink" href="#api-reference-files" title="Permalink to this heading">¶</a></h1>
<section id="file-hs-h">
<h2>File: hs.h<a class="headerlink" href="#file-hs-h" title="Permalink to this heading">¶</a></h2>
<p>The complete Hyperscan API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header includes both the Hyperscan compiler and runtime components. See the individual component headers for documentation. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MAJOR">
<span class="target" id="hs_8h_1a58442be0e18cfb0594fd11e054b7b893"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MAJOR</span></span></span><a class="headerlink" href="#c.HS_MAJOR" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MINOR">
<span class="target" id="hs_8h_1a71156368b5340469a20c23635d617d64"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MINOR</span></span></span><a class="headerlink" href="#c.HS_MINOR" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_PATCH">
<span class="target" id="hs_8h_1ab41a84244d74e912e32aa810c084f240"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_PATCH</span></span></span><a class="headerlink" href="#c.HS_PATCH" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</section>
<section id="file-hs-common-h">
<h2>File: hs_common.h<a class="headerlink" href="#file-hs-common-h" title="Permalink to this heading">¶</a></h2>
<p>The Hyperscan common API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header contains functions available to both the Hyperscan compiler and runtime. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_SUCCESS">
<span class="target" id="group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_SUCCESS</span></span></span><br /></dt>
<dd><p>The engine completed normally. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_INVALID">
<span class="target" id="group__HS__ERROR_1ga90b69de15d46488887c0522c2864bab9"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_INVALID</span></span></span><br /></dt>
<dd><p>A parameter passed to this function was invalid.</p>
<p>This error is only returned in cases where the function can detect an invalid parameter  it cannot be relied upon to detect (for example) pointers to freed memory or other invalid data. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_NOMEM">
<span class="target" id="group__HS__ERROR_1ga209e23f064df891f66575950b383832c"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_NOMEM</span></span></span><br /></dt>
<dd><p>A memory allocation failed. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_SCAN_TERMINATED">
<span class="target" id="group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_SCAN_TERMINATED</span></span></span><br /></dt>
<dd><p>The engine was terminated by callback.</p>
<p>This return value indicates that the target buffer was partially scanned, but that the callback function requested that scanning cease after a match was located. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_COMPILER_ERROR">
<span class="target" id="group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_COMPILER_ERROR</span></span></span><br /></dt>
<dd><p>The pattern compiler failed, and the <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> should be inspected for more detail. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_DB_VERSION_ERROR">
<span class="target" id="group__HS__ERROR_1ga86a4e9b45ad47bbae163888f2ef56fab"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_DB_VERSION_ERROR</span></span></span><br /></dt>
<dd><p>The given database was built for a different version of Hyperscan. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_DB_PLATFORM_ERROR">
<span class="target" id="group__HS__ERROR_1ga818162ba342f880040cad7350ba3f709"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_DB_PLATFORM_ERROR</span></span></span><br /></dt>
<dd><p>The given database was built for a different platform (i.e., CPU type). </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_DB_MODE_ERROR">
<span class="target" id="group__HS__ERROR_1ga5473f52d0822ef95125c54a21ee6d463"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_DB_MODE_ERROR</span></span></span><br /></dt>
<dd><p>The given database was built for a different mode of operation. This error is returned when streaming calls are used with a block or vectored database and vice versa. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_BAD_ALIGN">
<span class="target" id="group__HS__ERROR_1ga65b0cd2c66f76b4a4a64967052fd34ac"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_BAD_ALIGN</span></span></span><br /></dt>
<dd><p>A parameter passed to this function was not correctly aligned. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_BAD_ALLOC">
<span class="target" id="group__HS__ERROR_1ga9fd16f0296f0444eb6d7047ecbfddf4e"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_BAD_ALLOC</span></span></span><br /></dt>
<dd><p>The memory allocator (either malloc() or the allocator set with <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>) did not correctly return memory suitably aligned for the largest representable data type on this platform. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_SCRATCH_IN_USE">
<span class="target" id="group__HS__ERROR_1gae8edde7b8d481066abf249741277c8a5"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_SCRATCH_IN_USE</span></span></span><br /></dt>
<dd><p>The scratch region was already in use.</p>
<p>This error is returned when Hyperscan is able to detect that the scratch region given is already in use by another Hyperscan API call.</p>
<p>A separate scratch region, allocated with <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a> or <a class="reference internal" href="#hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"><span class="std std-ref">hs_clone_scratch()</span></a>, is required for every concurrent caller of the Hyperscan API.</p>
<p>For example, this error might be returned when <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a> has been called inside a callback delivered by a currently-executing <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a> call using the same scratch region.</p>
<p>Note: Not all concurrent uses of scratch regions may be detected. This error is intended as a best-effort debugging tool, not a guarantee. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_ARCH_ERROR">
<span class="target" id="group__HS__ERROR_1ga6a5a096e8d045791fc7eaa131ab8f1d2"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_ARCH_ERROR</span></span></span><br /></dt>
<dd><p>Unsupported CPU architecture.</p>
<p>This error is returned when Hyperscan is able to detect that the current system does not support the required instruction set.</p>
<p>At a minimum, Hyperscan requires Supplemental Streaming SIMD Extensions 3 (SSSE3). </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_INSUFFICIENT_SPACE">
<span class="target" id="group__HS__ERROR_1ga5cda332b921d1f8022bdb4454047a815"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_INSUFFICIENT_SPACE</span></span></span><br /></dt>
<dd><p>Provided buffer was too small.</p>
<p>This error indicates that there was insufficient space in the buffer. The call should be repeated with a larger provided buffer.</p>
<p>Note: in this situation, it is normal for the amount of space required to be returned in the same manner as the used space would have been returned if the call was successful. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_UNKNOWN_ERROR">
<span class="target" id="group__HS__ERROR_1ga4af7a75cb97118ed017dbb07c270277c"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_UNKNOWN_ERROR</span></span></span><br /></dt>
<dd><p>Unexpected internal error.</p>
<p>This error indicates that there was unexpected matching behaviors. This could be related to invalid usage of stream and scratch space or invalid memory operations by users. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.hs_database_t">
<span class="target" id="hs__common_8h_1aaabb7a1acc5b6a1efd377af877717b92"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">hs_database</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_database_t</span></span></span><a class="headerlink" href="#c.hs_database_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A Hyperscan pattern database.</p>
<p>Generated by one of the Hyperscan compiler functions:<ul class="simple">
<li><p><a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a></p></li>
<li><p><a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a></p></li>
<li><p><a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a> </p></li>
</ul>
</p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.hs_error_t">
<span class="target" id="hs__common_8h_1abe162d33344545644ac583b4df13a09b"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_error_t</span></span></span><a class="headerlink" href="#c.hs_error_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A type for errors returned by Hyperscan functions. </p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.hs_alloc_t">
<span class="target" id="hs__common_8h_1aea68f4980062576e61e55406493658b3"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">hs_alloc_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.hs_alloc_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The type of the callback function that will be used by Hyperscan to allocate more memory at runtime as required, for example in <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a> to allocate stream state.</p>
<p>If Hyperscan is to be used in a multi-threaded, or similarly concurrent environment, the allocation function will need to be re-entrant, or similarly safe for concurrent use.</p>
<dl class="field-list simple">
<dt class="field-odd">Param size</dt>
<dd class="field-odd"><p>The number of bytes to allocate. </p>
</dd>
<dt class="field-even">Return</dt>
<dd class="field-even"><p>A pointer to the region of memory allocated, or NULL on error. </p>
</dd>
</dl>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.hs_free_t">
<span class="target" id="hs__common_8h_1aae101e29ee28c489d0f1b1c4c3e5ba2a"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">hs_free_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ptr</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.hs_free_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The type of the callback function that will be used by Hyperscan to free memory regions previously allocated using the <a class="reference internal" href="#hs__common_8h_1aea68f4980062576e61e55406493658b3"><span class="std std-ref">hs_alloc_t</span></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Param ptr</dt>
<dd class="field-odd"><p>The region of memory to be freed. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.hs_free_database">
<span class="target" id="hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_free_database</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_free_database" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free a compiled pattern database.</p>
<p>The free callback set by <a class="reference internal" href="#hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"><span class="std std-ref">hs_set_database_allocator()</span></a> (or <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>) will be used by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – A compiled pattern database. NULL may also be safely provided, in which case the function does nothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_serialize_database">
<span class="target" id="hs__common_8h_1accea8a4a5481683e0564058621c9b8de"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_serialize_database</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bytes</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_serialize_database" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Serialize a pattern database to a stream of bytes.</p>
<p>The allocator callback set by <a class="reference internal" href="#hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span class="std std-ref">hs_set_misc_allocator()</span></a> (or <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>) will be used by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – A compiled pattern database.</p></li>
<li><p><strong>bytes</strong> – On success, a pointer to an array of bytes will be returned here. These bytes can be subsequently relocated or written to disk. The caller is responsible for freeing this block.</p></li>
<li><p><strong>length</strong> – On success, the number of bytes in the generated byte array will be returned here.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, <a class="reference internal" href="#group__HS__ERROR_1ga209e23f064df891f66575950b383832c"><span class="std std-ref">HS_NOMEM</span></a> if the byte array cannot be allocated, other values may be returned if errors are detected. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_deserialize_database">
<span class="target" id="hs__common_8h_1a87007f735bc81c5d3b5865dbd38ec5b7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_deserialize_database</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bytes</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_deserialize_database" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reconstruct a pattern database from a stream of bytes previously generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a>.</p>
<p>This function will allocate sufficient space for the database using the allocator set with <a class="reference internal" href="#hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"><span class="std std-ref">hs_set_database_allocator()</span></a> (or <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>); to use a pre-allocated region of memory, use the <a class="reference internal" href="#hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"><span class="std std-ref">hs_deserialize_database_at()</span></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bytes</strong> – A byte array generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a> representing a compiled pattern database.</p></li>
<li><p><strong>length</strong> – The length of the byte array generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a>. This should be the same value as that returned by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a>.</p></li>
<li><p><strong>db</strong> – On success, a pointer to a newly allocated <a class="reference internal" href="#hs__common_8h_1aaabb7a1acc5b6a1efd377af877717b92"><span class="std std-ref">hs_database_t</span></a> will be returned here. This database can then be used for scanning, and eventually freed by the caller using <a class="reference internal" href="#hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span class="std std-ref">hs_free_database()</span></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_deserialize_database_at">
<span class="target" id="hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_deserialize_database_at</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bytes</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_deserialize_database_at" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reconstruct a pattern database from a stream of bytes previously generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a> at a given memory location.</p>
<p>This function (unlike <a class="reference internal" href="#hs__common_8h_1a87007f735bc81c5d3b5865dbd38ec5b7"><span class="std std-ref">hs_deserialize_database()</span></a>) will write the reconstructed database to the memory location given in the <code class="docutils literal notranslate"><span class="pre">db</span></code> parameter. The amount of space required at this location can be determined with the <a class="reference internal" href="#hs__common_8h_1a83006d0498780313470c84d67e9181b7"><span class="std std-ref">hs_serialized_database_size()</span></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bytes</strong> – A byte array generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a> representing a compiled pattern database.</p></li>
<li><p><strong>length</strong> – The length of the byte array generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a>. This should be the same value as that returned by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a>.</p></li>
<li><p><strong>db</strong> – Pointer to an 8-byte aligned block of memory of sufficient size to hold the deserialized database. On success, the reconstructed database will be written to this location. This database can then be used for pattern matching. The user is responsible for freeing this memory; the <a class="reference internal" href="#hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span class="std std-ref">hs_free_database()</span></a> call should not be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_stream_size">
<span class="target" id="hs__common_8h_1a7cadd0a7ec7c50d8f6d52826635b9451"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_stream_size</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">database</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stream_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_stream_size" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Provides the size of the stream state allocated by a single stream opened against the given database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> – Pointer to a compiled (streaming mode) pattern database.</p></li>
<li><p><strong>stream_size</strong> – On success, the size in bytes of an individual stream opened against the given database is placed in this parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_database_size">
<span class="target" id="hs__common_8h_1a54d7c123674f04578a58b84e625618e2"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_database_size</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">database</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">database_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_database_size" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Provides the size of the given database in bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> – Pointer to compiled pattern database.</p></li>
<li><p><strong>database_size</strong> – On success, the size of the compiled database in bytes is placed in this parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_serialized_database_size">
<span class="target" id="hs__common_8h_1a83006d0498780313470c84d67e9181b7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_serialized_database_size</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bytes</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">deserialized_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_serialized_database_size" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Utility function for reporting the size that would be required by a database if it were deserialized.</p>
<p>This can be used to allocate a shared memory region or other “special” allocation prior to deserializing with the <a class="reference internal" href="#hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"><span class="std std-ref">hs_deserialize_database_at()</span></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bytes</strong> – Pointer to a byte array generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a> representing a compiled pattern database.</p></li>
<li><p><strong>length</strong> – The length of the byte array generated by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a>. This should be the same value as that returned by <a class="reference internal" href="#hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span class="std std-ref">hs_serialize_database()</span></a>.</p></li>
<li><p><strong>deserialized_size</strong> – On success, the size of the compiled database that would be generated by <a class="reference internal" href="#hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"><span class="std std-ref">hs_deserialize_database_at()</span></a> is returned here.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_database_info">
<span class="target" id="hs__common_8h_1a1a3e15ded02d1731bd761fc71d1a6246"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_database_info</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">database</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">info</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_database_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Utility function providing information about a database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> – Pointer to a compiled database.</p></li>
<li><p><strong>info</strong> – On success, a string containing the version and platform information for the supplied database is placed in the parameter. The string is allocated using the allocator supplied in <a class="reference internal" href="#hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span class="std std-ref">hs_set_misc_allocator()</span></a> (or malloc() if no allocator was set) and should be freed by the caller.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_serialized_database_info">
<span class="target" id="hs__common_8h_1adb78b881b1526fd85be4492c1d52e478"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_serialized_database_info</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bytes</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">info</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_serialized_database_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Utility function providing information about a serialized database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bytes</strong> – Pointer to a serialized database.</p></li>
<li><p><strong>length</strong> – Length in bytes of the serialized database.</p></li>
<li><p><strong>info</strong> – On success, a string containing the version and platform information for the supplied serialized database is placed in the parameter. The string is allocated using the allocator supplied in <a class="reference internal" href="#hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span class="std std-ref">hs_set_misc_allocator()</span></a> (or malloc() if no allocator was set) and should be freed by the caller.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_set_allocator">
<span class="target" id="hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_set_allocator</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t"><span class="n"><span class="pre">hs_alloc_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">alloc_func</span></span>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t"><span class="n"><span class="pre">hs_free_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">free_func</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_allocator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory at runtime for stream state, scratch space, database bytecode, and various other data structure returned by the Hyperscan API.</p>
<p>The function is equivalent to calling <a class="reference internal" href="#hs__common_8h_1a1815c5493f89e85b7bc0557a4f89179d"><span class="std std-ref">hs_set_stream_allocator()</span></a>, <a class="reference internal" href="#hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span class="std std-ref">hs_set_scratch_allocator()</span></a>, <a class="reference internal" href="#hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"><span class="std std-ref">hs_set_database_allocator()</span></a> and <a class="reference internal" href="#hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span class="std std-ref">hs_set_misc_allocator()</span></a> with the provided parameters.</p>
<p>This call will override any previous allocators that have been set.</p>
<p>Note: there is no way to change the allocator used for temporary objects created during the various compile calls (<a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a>, <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alloc_func</strong> – A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p></li>
<li><p><strong>free_func</strong> – A callback function pointer that frees allocated memory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_set_database_allocator">
<span class="target" id="hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_set_database_allocator</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t"><span class="n"><span class="pre">hs_alloc_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">alloc_func</span></span>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t"><span class="n"><span class="pre">hs_free_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">free_func</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_database_allocator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for database bytecode produced by the compile calls (<a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a>, <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>) and by database deserialization (<a class="reference internal" href="#hs__common_8h_1a87007f735bc81c5d3b5865dbd38ec5b7"><span class="std std-ref">hs_deserialize_database()</span></a>).</p>
<p>If no database allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous database allocators that have been set.</p>
<p>Note: the database allocator may also be set by calling <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>.</p>
<p>Note: there is no way to change how temporary objects created during the various compile calls (<a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a>, <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>) are allocated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alloc_func</strong> – A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p></li>
<li><p><strong>free_func</strong> – A callback function pointer that frees allocated memory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_set_misc_allocator">
<span class="target" id="hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_set_misc_allocator</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t"><span class="n"><span class="pre">hs_alloc_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">alloc_func</span></span>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t"><span class="n"><span class="pre">hs_free_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">free_func</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_misc_allocator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for items returned by the Hyperscan API such as <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a>, <a class="reference internal" href="#hs__compile_8h_1ab299ce60736a43eca45e34d2eaf2462f"><span class="std std-ref">hs_expr_info_t</span></a> and serialized databases.</p>
<p>If no misc allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous misc allocators that have been set.</p>
<p>Note: the misc allocator may also be set by calling <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alloc_func</strong> – A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p></li>
<li><p><strong>free_func</strong> – A callback function pointer that frees allocated memory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_set_scratch_allocator">
<span class="target" id="hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_set_scratch_allocator</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t"><span class="n"><span class="pre">hs_alloc_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">alloc_func</span></span>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t"><span class="n"><span class="pre">hs_free_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">free_func</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_scratch_allocator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for scratch space by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a> and <a class="reference internal" href="#hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"><span class="std std-ref">hs_clone_scratch()</span></a>.</p>
<p>If no scratch allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous scratch allocators that have been set.</p>
<p>Note: the scratch allocator may also be set by calling <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alloc_func</strong> – A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p></li>
<li><p><strong>free_func</strong> – A callback function pointer that frees allocated memory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_set_stream_allocator">
<span class="target" id="hs__common_8h_1a1815c5493f89e85b7bc0557a4f89179d"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_set_stream_allocator</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t"><span class="n"><span class="pre">hs_alloc_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">alloc_func</span></span>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t"><span class="n"><span class="pre">hs_free_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">free_func</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_stream_allocator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for stream state by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>.</p>
<p>If no stream allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous stream allocators that have been set.</p>
<p>Note: the stream allocator may also be set by calling <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alloc_func</strong> – A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p></li>
<li><p><strong>free_func</strong> – A callback function pointer that frees allocated memory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_version">
<span class="target" id="hs__common_8h_1a99b7f534126187659c730ee63b131b1f"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">hs_version</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_version" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Utility function for identifying this release version.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A string containing the version number of this release build and the date of the build. It is allocated statically, so it does not need to be freed by the caller. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_valid_platform">
<span class="target" id="hs__common_8h_1a52ea558e163ea0508fb74b8711089391"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_valid_platform</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_valid_platform" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Utility function to test the current system architecture.</p>
<p>Hyperscan requires the Supplemental Streaming SIMD Extensions 3 instruction set. This function can be called on any x86 platform to determine if the system provides the required instruction set.</p>
<p>This function does not test for more advanced features if Hyperscan has been built for a more specific architecture, for example the AVX2 instruction set.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, <a class="reference internal" href="#group__HS__ERROR_1ga6a5a096e8d045791fc7eaa131ab8f1d2"><span class="std std-ref">HS_ARCH_ERROR</span></a> if system does not support Hyperscan. </p>
</dd>
</dl>
</dd></dl>

</div>
</section>
<section id="file-hs-compile-h">
<h2>File: hs_compile.h<a class="headerlink" href="#file-hs-compile-h" title="Permalink to this heading">¶</a></h2>
<p>The Hyperscan compiler API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header contains functions for compiling regular expressions into Hyperscan databases that can be used by the Hyperscan runtime. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_EXT_FLAG_MIN_OFFSET">
<span class="target" id="group__HS__EXT__FLAG_1ga8876e1c519442ec4feb47508e03a6c52"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_EXT_FLAG_MIN_OFFSET</span></span></span><br /></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#strucths__expr__ext_1a006843974cb05dbf16291da621a72fa9"><span class="std std-ref">hs_expr_ext::min_offset</span></a> field is used. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_EXT_FLAG_MAX_OFFSET">
<span class="target" id="group__HS__EXT__FLAG_1ga7f68e1f3b5ad7c39165e56f294aab5f8"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_EXT_FLAG_MAX_OFFSET</span></span></span><br /></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#strucths__expr__ext_1a263c613f20c6b8ef30ca01785e0f55fc"><span class="std std-ref">hs_expr_ext::max_offset</span></a> field is used. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_EXT_FLAG_MIN_LENGTH">
<span class="target" id="group__HS__EXT__FLAG_1ga08b4bfb7f87b2f768c470ede24a724b6"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_EXT_FLAG_MIN_LENGTH</span></span></span><br /></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#strucths__expr__ext_1a6afdac1e0bb89d9a76d6c91ed86a6fe8"><span class="std std-ref">hs_expr_ext::min_length</span></a> field is used. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_EXT_FLAG_EDIT_DISTANCE">
<span class="target" id="group__HS__EXT__FLAG_1gac557ac5c1da1649b151ac435ea56d41c"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_EXT_FLAG_EDIT_DISTANCE</span></span></span><br /></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#strucths__expr__ext_1a8b7536c6ca0b01faa975b195e04b3913"><span class="std std-ref">hs_expr_ext::edit_distance</span></a> field is used. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_EXT_FLAG_HAMMING_DISTANCE">
<span class="target" id="group__HS__EXT__FLAG_1ga0568165f31e3bf0ece0e4466840ca466"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_EXT_FLAG_HAMMING_DISTANCE</span></span></span><br /></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#strucths__expr__ext_1a94072afd1400402fad2e59c6dbdb7973"><span class="std std-ref">hs_expr_ext::hamming_distance</span></a> field is used. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_CASELESS">
<span class="target" id="group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_CASELESS</span></span></span><br /></dt>
<dd><p>Compile flag: Set case-insensitive matching.</p>
<p>This flag sets the expression to be matched case-insensitively by default. The expression may still use PCRE tokens (notably <code class="docutils literal notranslate"><span class="pre">(?i)</span></code> and <code class="docutils literal notranslate"><span class="pre">(?-i)</span></code>) to switch case-insensitive matching on and off. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_DOTALL">
<span class="target" id="group__HS__PATTERN__FLAG_1gae7a43d25b9c00e34836ad752ad4eded5"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_DOTALL</span></span></span><br /></dt>
<dd><p>Compile flag: Matching a <code class="docutils literal notranslate"><span class="pre">.</span></code> will not exclude newlines.</p>
<p>This flag sets any instances of the <code class="docutils literal notranslate"><span class="pre">.</span></code> token to match newline characters as well as all other characters. The PCRE specification states that the <code class="docutils literal notranslate"><span class="pre">.</span></code> token does not match newline characters by default, so without this flag the <code class="docutils literal notranslate"><span class="pre">.</span></code> token will not cross line boundaries. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_MULTILINE">
<span class="target" id="group__HS__PATTERN__FLAG_1ga83f3cf5bad826b3fb874d88b0a0b00e8"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_MULTILINE</span></span></span><br /></dt>
<dd><p>Compile flag: Set multi-line anchoring.</p>
<p>This flag instructs the expression to make the <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> tokens match newline characters as well as the start and end of the stream. If this flag is not specified, the <code class="docutils literal notranslate"><span class="pre">^</span></code> token will only ever match at the start of a stream, and the <code class="docutils literal notranslate"><span class="pre">$</span></code> token will only ever match at the end of a stream within the guidelines of the PCRE specification. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_SINGLEMATCH">
<span class="target" id="group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_SINGLEMATCH</span></span></span><br /></dt>
<dd><p>Compile flag: Set single-match only mode.</p>
<p>This flag sets the expression’s match ID to match at most once. In streaming mode, this means that the expression will return only a single match over the lifetime of the stream, rather than reporting every match as per standard Hyperscan semantics. In block mode or vectored mode, only the first match for each invocation of <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a> or <a class="reference internal" href="#hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"><span class="std std-ref">hs_scan_vector()</span></a> will be returned.</p>
<p>If multiple expressions in the database share the same match ID, then they either must all specify <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"><span class="std std-ref">HS_FLAG_SINGLEMATCH</span></a> or none of them specify <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"><span class="std std-ref">HS_FLAG_SINGLEMATCH</span></a>. If a group of expressions sharing a match ID specify the flag, then at most one match with the match ID will be generated per stream.</p>
<p>Note: The use of this flag in combination with <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span class="std std-ref">HS_FLAG_SOM_LEFTMOST</span></a> is not currently supported. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_ALLOWEMPTY">
<span class="target" id="group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_ALLOWEMPTY</span></span></span><br /></dt>
<dd><p>Compile flag: Allow expressions that can match against empty buffers.</p>
<p>This flag instructs the compiler to allow expressions that can match against empty buffers, such as <code class="docutils literal notranslate"><span class="pre">.?</span></code>, <code class="docutils literal notranslate"><span class="pre">.*</span></code>, <code class="docutils literal notranslate"><span class="pre">(a|)</span></code>. Since Hyperscan can return every possible match for an expression, such expressions generally execute very slowly; the default behaviour is to return an error when an attempt to compile one is made. Using this flag will force the compiler to allow such an expression. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_UTF8">
<span class="target" id="group__HS__PATTERN__FLAG_1ga8c95741825e963834f8f53dd545132bd"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_UTF8</span></span></span><br /></dt>
<dd><p>Compile flag: Enable UTF-8 mode for this expression.</p>
<p>This flag instructs Hyperscan to treat the pattern as a sequence of UTF-8 characters. The results of scanning invalid UTF-8 sequences with a Hyperscan library that has been compiled with one or more patterns using this flag are undefined. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_UCP">
<span class="target" id="group__HS__PATTERN__FLAG_1ga5b80baf97382e0a314d6ed424033b27c"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_UCP</span></span></span><br /></dt>
<dd><p>Compile flag: Enable Unicode property support for this expression.</p>
<p>This flag instructs Hyperscan to use Unicode properties, rather than the default ASCII interpretations, for character mnemonics like <code class="docutils literal notranslate"><span class="pre">\w</span></code> and <code class="docutils literal notranslate"><span class="pre">\s</span></code> as well as the POSIX character classes. It is only meaningful in conjunction with <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga8c95741825e963834f8f53dd545132bd"><span class="std std-ref">HS_FLAG_UTF8</span></a>. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_PREFILTER">
<span class="target" id="group__HS__PATTERN__FLAG_1gaf22d466addab2cf9f050cc8856baf685"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_PREFILTER</span></span></span><br /></dt>
<dd><p>Compile flag: Enable prefiltering mode for this expression.</p>
<p>This flag instructs Hyperscan to compile an “approximate” version of this pattern for use in a prefiltering application, even if Hyperscan does not support the pattern in normal operation.</p>
<p>The set of matches returned when this flag is used is guaranteed to be a superset of the matches specified by the non-prefiltering expression.</p>
<p>If the pattern contains pattern constructs not supported by Hyperscan (such as zero-width assertions, back-references or conditional references) these constructs will be replaced internally with broader constructs that may match more often.</p>
<p>Furthermore, in prefiltering mode Hyperscan may simplify a pattern that would otherwise return a “Pattern too large” error at compile time, or for performance reasons (subject to the matching guarantee above).</p>
<p>It is generally expected that the application will subsequently confirm prefilter matches with another regular expression matcher that can provide exact matches for the pattern.</p>
<p>Note: The use of this flag in combination with <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span class="std std-ref">HS_FLAG_SOM_LEFTMOST</span></a> is not currently supported. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_SOM_LEFTMOST">
<span class="target" id="group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_SOM_LEFTMOST</span></span></span><br /></dt>
<dd><p>Compile flag: Enable leftmost start of match reporting.</p>
<p>This flag instructs Hyperscan to report the leftmost possible start of match offset when a match is reported for this expression. (By default, no start of match is returned.)</p>
<p>For all the 3 modes, enabling this behaviour may reduce performance. And particularly, it may increase stream state requirements in streaming mode. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_COMBINATION">
<span class="target" id="group__HS__PATTERN__FLAG_1gae09985fdb55c3347bf2da7b7c2ea9128"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_COMBINATION</span></span></span><br /></dt>
<dd><p>Compile flag: Logical combination.</p>
<p>This flag instructs Hyperscan to parse this expression as logical combination syntax. Logical constraints consist of operands, operators and parentheses. The operands are expression indices, and operators can be ‘!’(NOT), ‘&amp;’(AND) or ‘|’(OR). For example: (101&amp;102&amp;103)|(104&amp;!105) ((301|302)&amp;303)&amp;(304|305) </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_FLAG_QUIET">
<span class="target" id="group__HS__PATTERN__FLAG_1gaa534c7cc49697159a2c3c1b4f559167a"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_FLAG_QUIET</span></span></span><br /></dt>
<dd><p>Compile flag: Don’t do any match reporting.</p>
<p>This flag instructs Hyperscan to ignore match reporting for this expression. It is designed to be used on the sub-expressions in logical combinations. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_CPU_FEATURES_AVX2">
<span class="target" id="group__HS__CPU__FEATURES__FLAG_1ga1ae675026897399f27c610251b5f14a1"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_CPU_FEATURES_AVX2</span></span></span><br /></dt>
<dd><p>CPU features flag - Intel(R) Advanced Vector Extensions 2 (Intel(R) AVX2)</p>
<p>Setting this flag indicates that the target platform supports AVX2 instructions. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_CPU_FEATURES_AVX512">
<span class="target" id="group__HS__CPU__FEATURES__FLAG_1gab4debef714698071ee7ebbbf052a9031"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_CPU_FEATURES_AVX512</span></span></span><br /></dt>
<dd><p>CPU features flag - Intel(R) Advanced Vector Extensions 512 (Intel(R) AVX512)</p>
<p>Setting this flag indicates that the target platform supports AVX512 instructions, specifically AVX-512BW. Using AVX512 implies the use of AVX2. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_CPU_FEATURES_AVX512VBMI">
<span class="target" id="group__HS__CPU__FEATURES__FLAG_1ga031af10046791354719ad10d70322347"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_CPU_FEATURES_AVX512VBMI</span></span></span><br /></dt>
<dd><p>CPU features flag - Intel(R) Advanced Vector Extensions 512 Vector Byte Manipulation Instructions (Intel(R) AVX512VBMI)</p>
<p>Setting this flag indicates that the target platform supports AVX512VBMI instructions. Using AVX512VBMI implies the use of AVX512. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_GENERIC">
<span class="target" id="group__HS__TUNE__FLAG_1ga8432f59942aa4116d0bb89ea469c7f25"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_GENERIC</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Generic</p>
<p>This indicates that the compiled database should not be tuned for any particular target platform. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_SNB">
<span class="target" id="group__HS__TUNE__FLAG_1ga03f9adc14171ba88fab2096cf4c85dd1"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_SNB</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Sandy Bridge</p>
<p>This indicates that the compiled database should be tuned for the Sandy Bridge microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_IVB">
<span class="target" id="group__HS__TUNE__FLAG_1ga4450c117ef6d6e93e17738d104a6d6bf"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_IVB</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Ivy Bridge</p>
<p>This indicates that the compiled database should be tuned for the Ivy Bridge microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_HSW">
<span class="target" id="group__HS__TUNE__FLAG_1gad0f321a370c54c685face8e280194440"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_HSW</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Haswell</p>
<p>This indicates that the compiled database should be tuned for the Haswell microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_SLM">
<span class="target" id="group__HS__TUNE__FLAG_1ga921644d03211ed07e348d25c4ee4a6d9"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_SLM</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Silvermont</p>
<p>This indicates that the compiled database should be tuned for the Silvermont microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_BDW">
<span class="target" id="group__HS__TUNE__FLAG_1gac36ec4d90f461d6889cbdf5f7713f2ae"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_BDW</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Broadwell</p>
<p>This indicates that the compiled database should be tuned for the Broadwell microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_SKL">
<span class="target" id="group__HS__TUNE__FLAG_1gaf432d6ee10507b5ba152e433708bd31a"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_SKL</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Skylake</p>
<p>This indicates that the compiled database should be tuned for the Skylake microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_SKX">
<span class="target" id="group__HS__TUNE__FLAG_1ga0b9f49e8d711f3a6e4590ac98be3f1d5"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_SKX</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Skylake Server</p>
<p>This indicates that the compiled database should be tuned for the Skylake Server microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_GLM">
<span class="target" id="group__HS__TUNE__FLAG_1ga37354d7425dc1fe5b661abe1729596b8"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_GLM</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Goldmont</p>
<p>This indicates that the compiled database should be tuned for the Goldmont microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_ICL">
<span class="target" id="group__HS__TUNE__FLAG_1ga80464a81816ebbc0368fa2398f800c78"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_ICL</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Icelake</p>
<p>This indicates that the compiled database should be tuned for the Icelake microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_TUNE_FAMILY_ICX">
<span class="target" id="group__HS__TUNE__FLAG_1ga4afb8b2ad81c143f4b6699987d781f50"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_TUNE_FAMILY_ICX</span></span></span><br /></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Icelake Server</p>
<p>This indicates that the compiled database should be tuned for the Icelake Server microarchitecture. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MODE_BLOCK">
<span class="target" id="group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MODE_BLOCK</span></span></span><br /></dt>
<dd><p>Compiler mode flag: Block scan (non-streaming) database. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MODE_NOSTREAM">
<span class="target" id="group__HS__MODE__FLAG_1gadb61c31eca1b60fe0dba5b05c457a0ef"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MODE_NOSTREAM</span></span></span><br /></dt>
<dd><p>Compiler mode flag: Alias for <a class="reference internal" href="#group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span class="std std-ref">HS_MODE_BLOCK</span></a>. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MODE_STREAM">
<span class="target" id="group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MODE_STREAM</span></span></span><br /></dt>
<dd><p>Compiler mode flag: Streaming database. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MODE_VECTORED">
<span class="target" id="group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MODE_VECTORED</span></span></span><br /></dt>
<dd><p>Compiler mode flag: Vectored scanning database. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MODE_SOM_HORIZON_LARGE">
<span class="target" id="group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MODE_SOM_HORIZON_LARGE</span></span></span><br /></dt>
<dd><p>Compiler mode flag: use full precision to track start of match offsets in stream state.</p>
<p>This mode will use the most stream state per pattern, but will always return an accurate start of match offset regardless of how far back in the past it was found.</p>
<p>One of the SOM_HORIZON modes must be selected to use the <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span class="std std-ref">HS_FLAG_SOM_LEFTMOST</span></a> expression flag. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MODE_SOM_HORIZON_MEDIUM">
<span class="target" id="group__HS__MODE__FLAG_1gac96611d51f322cd0b20b536e73f8c5c5"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MODE_SOM_HORIZON_MEDIUM</span></span></span><br /></dt>
<dd><p>Compiler mode flag: use medium precision to track start of match offsets in stream state.</p>
<p>This mode will use less stream state than <a class="reference internal" href="#group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"><span class="std std-ref">HS_MODE_SOM_HORIZON_LARGE</span></a> and will limit start of match accuracy to offsets within 2^32 bytes of the end of match offset reported.</p>
<p>One of the SOM_HORIZON modes must be selected to use the <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span class="std std-ref">HS_FLAG_SOM_LEFTMOST</span></a> expression flag. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_MODE_SOM_HORIZON_SMALL">
<span class="target" id="group__HS__MODE__FLAG_1gad2e9e62af82d553dc0660f006227dd8f"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_MODE_SOM_HORIZON_SMALL</span></span></span><br /></dt>
<dd><p>Compiler mode flag: use limited precision to track start of match offsets in stream state.</p>
<p>This mode will use less stream state than <a class="reference internal" href="#group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"><span class="std std-ref">HS_MODE_SOM_HORIZON_LARGE</span></a> and will limit start of match accuracy to offsets within 2^16 bytes of the end of match offset reported.</p>
<p>One of the SOM_HORIZON modes must be selected to use the <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span class="std std-ref">HS_FLAG_SOM_LEFTMOST</span></a> expression flag. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.hs_compile_error_t">
<span class="target" id="hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_compile_error" title="hs_compile_error"><span class="n"><span class="pre">hs_compile_error</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compile_error_t</span></span></span><a class="headerlink" href="#c.hs_compile_error_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A type containing error details that is returned by the compile calls (<a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a> and <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>) on failure. The caller may inspect the values returned in this type to determine the cause of failure.</p>
<p>Common errors generated during the compile process include:</p>
<p><ul>
<li><p><em>Invalid parameter</em></p>
<p>An invalid argument was specified in the compile call.</p>
</li>
<li><p><em>Unrecognised flag</em></p>
<p>An unrecognised value was passed in the flags argument.</p>
</li>
<li><p><em>Pattern matches empty buffer</em></p>
<p>By default, Hyperscan only supports patterns that will <em>always</em> consume at least one byte of input. Patterns that do not have this property (such as <code class="docutils literal notranslate"><span class="pre">/(abc)?/</span></code>) will produce this error unless the <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"><span class="std std-ref">HS_FLAG_ALLOWEMPTY</span></a> flag is supplied. Note that such patterns will produce a match for <em>every</em> byte when scanned.</p>
</li>
<li><p><em>Embedded anchors not supported</em></p>
<p>Hyperscan only supports the use of anchor meta-characters (such as <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code>) in patterns where they could <em>only</em> match at the start or end of a buffer. A pattern containing an embedded anchor, such as <code class="docutils literal notranslate"><span class="pre">/abc^def/</span></code>, can never match, as there is no way for <code class="docutils literal notranslate"><span class="pre">abc</span></code> to precede the start of the data stream.</p>
</li>
<li><p><em>Bounded repeat is too large</em></p>
<p>The pattern contains a repeated construct with very large finite bounds.</p>
</li>
<li><p><em>Unsupported component type</em></p>
<p>An unsupported PCRE construct was used in the pattern.</p>
</li>
<li><p><em>Unable to generate bytecode</em></p>
<p>This error indicates that Hyperscan was unable to compile a pattern that is syntactically valid. The most common cause is a pattern that is very long and complex or contains a large repeated subpattern.</p>
</li>
<li><p><em>Unable to allocate memory</em></p>
<p>The library was unable to allocate temporary storage used during compilation time.</p>
</li>
<li><p><em>Allocator returned misaligned memory</em></p>
<p>The memory allocator (either malloc() or the allocator set with <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>) did not correctly return memory suitably aligned for the largest representable data type on this platform.</p>
</li>
<li><p><em>Internal error</em></p>
<p>An unexpected error occurred: if this error is reported, please contact the Hyperscan team with a description of the situation. </p>
</li>
</ul>
</p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.hs_platform_info_t">
<span class="target" id="hs__compile_8h_1a395df09d6535a2e80447c6afb0c1f340"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_platform_info" title="hs_platform_info"><span class="n"><span class="pre">hs_platform_info</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_platform_info_t</span></span></span><a class="headerlink" href="#c.hs_platform_info_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A type containing information on the target platform which may optionally be provided to the compile calls (<a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a>, <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>).</p>
<p>A <a class="reference internal" href="#strucths__platform__info"><span class="std std-ref">hs_platform_info</span></a> structure may be populated for the current platform by using the <a class="reference internal" href="#hs__compile_8h_1a7fba694199df776522bc959a43a0079c"><span class="std std-ref">hs_populate_platform()</span></a> call. </p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.hs_expr_info_t">
<span class="target" id="hs__compile_8h_1ab299ce60736a43eca45e34d2eaf2462f"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_expr_info" title="hs_expr_info"><span class="n"><span class="pre">hs_expr_info</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_expr_info_t</span></span></span><a class="headerlink" href="#c.hs_expr_info_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A type containing information related to an expression that is returned by <a class="reference internal" href="#hs__compile_8h_1a414dfeeb4fee8d2444b531cef4bed0a4"><span class="std std-ref">hs_expression_info()</span></a> or <a class="reference internal" href="#hs__compile_8h_1a007328330e6e0abbb4be5422015384b7"><span class="std std-ref">hs_expression_ext_info</span></a>. </p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.hs_expr_ext_t">
<span class="target" id="hs__compile_8h_1a5acd00a47f8519536b991df7d2f7be51"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_expr_ext" title="hs_expr_ext"><span class="n"><span class="pre">hs_expr_ext</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_expr_ext_t</span></span></span><a class="headerlink" href="#c.hs_expr_ext_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A structure containing additional parameters related to an expression, passed in at build time to <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a> or <a class="reference internal" href="#hs__compile_8h_1a007328330e6e0abbb4be5422015384b7"><span class="std std-ref">hs_expression_ext_info</span></a>.</p>
<p>These parameters allow the set of matches produced by a pattern to be constrained at compile time, rather than relying on the application to process unwanted matches at runtime. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.hs_compile">
<span class="target" id="hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compile</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">expression</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t"><span class="n"><span class="pre">hs_platform_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">platform</span></span>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The basic regular expression compiler.</p>
<p>This is the function call with which an expression is compiled into a Hyperscan database which can be passed to the runtime functions (such as <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a>, <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>, etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expression</strong> – The NULL-terminated expression to parse. Note that this string must represent ONLY the pattern to be matched, with no delimiters or flags; any global flags should be specified with the <code class="docutils literal notranslate"><span class="pre">flags</span></code> argument. For example, the expression <code class="docutils literal notranslate"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal notranslate"><span class="pre">abc?def</span></code> as the <code class="docutils literal notranslate"><span class="pre">expression</span></code>, and <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span class="std std-ref">HS_FLAG_CASELESS</span></a> as the <em>flags</em>.</p></li>
<li><p><strong>flags</strong> – Flags which modify the behaviour of the expression. Multiple flags may be used by ORing them together. Valid values are:<ul>
<li><p>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</p></li>
<li><p>HS_FLAG_DOTALL - Matching a <code class="docutils literal notranslate"><span class="pre">.</span></code> will not exclude newlines.</p></li>
<li><p>HS_FLAG_MULTILINE - <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> anchors match any newlines in data.</p></li>
<li><p>HS_FLAG_SINGLEMATCH - Only one match will be generated for the expression per stream.</p></li>
<li><p>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</p></li>
<li><p>HS_FLAG_UCP - Use Unicode properties for character classes.</p></li>
<li><p>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</p></li>
<li><p>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</p></li>
<li><p>HS_FLAG_COMBINATION - Parse the expression in logical combination syntax.</p></li>
<li><p>HS_FLAG_QUIET - Ignore match reporting for this expression. Used for the sub-expressions in logical combinations.</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> – Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span class="std std-ref">HS_MODE_STREAM</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span class="std std-ref">HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span class="std std-ref">HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p></li>
<li><p><strong>platform</strong> – If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p></li>
<li><p><strong>db</strong> – On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span class="std std-ref">hs_free_database()</span></a> function.</p></li>
<li><p><strong>error</strong> – If the compile fails, a pointer to a <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span class="std std-ref">hs_free_compile_error()</span></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span class="std std-ref">HS_COMPILER_ERROR</span></a> on failure, with details provided in the error parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_compile_multi">
<span class="target" id="hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compile_multi</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">expressions</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ids</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">elements</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t"><span class="n"><span class="pre">hs_platform_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">platform</span></span>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile_multi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The multiple regular expression compiler.</p>
<p>This is the function call with which a set of expressions is compiled into a database which can be passed to the runtime functions (such as <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a>, <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>, etc.) Each expression can be labelled with a unique integer which is passed into the match callback to identify the pattern that has matched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expressions</strong> – Array of NULL-terminated expressions to compile. Note that (as for <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>) these strings must contain only the pattern to be matched, with no delimiters or flags. For example, the expression <code class="docutils literal notranslate"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal notranslate"><span class="pre">abc?def</span></code> as the first string in the <code class="docutils literal notranslate"><span class="pre">expressions</span></code> array, and <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span class="std std-ref">HS_FLAG_CASELESS</span></a> as the first value in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> array.</p></li>
<li><p><strong>flags</strong> – Array of flags which modify the behaviour of each expression. Multiple flags may be used by ORing them together. Specifying the NULL pointer in place of an array will set the flags value for all patterns to zero. Valid values are:<ul>
<li><p>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</p></li>
<li><p>HS_FLAG_DOTALL - Matching a <code class="docutils literal notranslate"><span class="pre">.</span></code> will not exclude newlines.</p></li>
<li><p>HS_FLAG_MULTILINE - <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> anchors match any newlines in data.</p></li>
<li><p>HS_FLAG_SINGLEMATCH - Only one match will be generated by patterns with this match id per stream.</p></li>
<li><p>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</p></li>
<li><p>HS_FLAG_UCP - Use Unicode properties for character classes.</p></li>
<li><p>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</p></li>
<li><p>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</p></li>
<li><p>HS_FLAG_COMBINATION - Parse the expression in logical combination syntax.</p></li>
<li><p>HS_FLAG_QUIET - Ignore match reporting for this expression. Used for the sub-expressions in logical combinations.</p></li>
</ul>
</p></li>
<li><p><strong>ids</strong> – An array of integers specifying the ID number to be associated with the corresponding pattern in the expressions array. Specifying the NULL pointer in place of an array will set the ID value for all patterns to zero.</p></li>
<li><p><strong>elements</strong> – The number of elements in the input arrays.</p></li>
<li><p><strong>mode</strong> – Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span class="std std-ref">HS_MODE_STREAM</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span class="std std-ref">HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span class="std std-ref">HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p></li>
<li><p><strong>platform</strong> – If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p></li>
<li><p><strong>db</strong> – On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span class="std std-ref">hs_free_database()</span></a> function.</p></li>
<li><p><strong>error</strong> – If the compile fails, a pointer to a <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span class="std std-ref">hs_free_compile_error()</span></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span class="std std-ref">HS_COMPILER_ERROR</span></a> on failure, with details provided in the <code class="docutils literal notranslate"><span class="pre">error</span></code> parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_compile_ext_multi">
<span class="target" id="hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compile_ext_multi</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">expressions</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ids</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_expr_ext_t" title="hs_expr_ext_t"><span class="n"><span class="pre">hs_expr_ext_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ext</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">elements</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t"><span class="n"><span class="pre">hs_platform_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">platform</span></span>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile_ext_multi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The multiple regular expression compiler with extended parameter support.</p>
<p>This function call compiles a group of expressions into a database in the same way as <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a>, but allows additional parameters to be specified via an <a class="reference internal" href="#hs__compile_8h_1a5acd00a47f8519536b991df7d2f7be51"><span class="std std-ref">hs_expr_ext_t</span></a> structure per expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expressions</strong> – Array of NULL-terminated expressions to compile. Note that (as for <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>) these strings must contain only the pattern to be matched, with no delimiters or flags. For example, the expression <code class="docutils literal notranslate"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal notranslate"><span class="pre">abc?def</span></code> as the first string in the <code class="docutils literal notranslate"><span class="pre">expressions</span></code> array, and <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span class="std std-ref">HS_FLAG_CASELESS</span></a> as the first value in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> array.</p></li>
<li><p><strong>flags</strong> – Array of flags which modify the behaviour of each expression. Multiple flags may be used by ORing them together. Specifying the NULL pointer in place of an array will set the flags value for all patterns to zero. Valid values are:<ul>
<li><p>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</p></li>
<li><p>HS_FLAG_DOTALL - Matching a <code class="docutils literal notranslate"><span class="pre">.</span></code> will not exclude newlines.</p></li>
<li><p>HS_FLAG_MULTILINE - <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> anchors match any newlines in data.</p></li>
<li><p>HS_FLAG_SINGLEMATCH - Only one match will be generated by patterns with this match id per stream.</p></li>
<li><p>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</p></li>
<li><p>HS_FLAG_UCP - Use Unicode properties for character classes.</p></li>
<li><p>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</p></li>
<li><p>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</p></li>
<li><p>HS_FLAG_COMBINATION - Parse the expression in logical combination syntax.</p></li>
<li><p>HS_FLAG_QUIET - Ignore match reporting for this expression. Used for the sub-expressions in logical combinations.</p></li>
</ul>
</p></li>
<li><p><strong>ids</strong> – An array of integers specifying the ID number to be associated with the corresponding pattern in the expressions array. Specifying the NULL pointer in place of an array will set the ID value for all patterns to zero.</p></li>
<li><p><strong>ext</strong> – An array of pointers to filled <a class="reference internal" href="#hs__compile_8h_1a5acd00a47f8519536b991df7d2f7be51"><span class="std std-ref">hs_expr_ext_t</span></a> structures that define extended behaviour for each pattern. NULL may be specified if no extended behaviour is needed for an individual pattern, or in place of the whole array if it is not needed for any expressions. Memory used by these structures must be both allocated and freed by the caller.</p></li>
<li><p><strong>elements</strong> – The number of elements in the input arrays.</p></li>
<li><p><strong>mode</strong> – Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span class="std std-ref">HS_MODE_STREAM</span></a>, <a class="reference internal" href="#group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span class="std std-ref">HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span class="std std-ref">HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p></li>
<li><p><strong>platform</strong> – If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p></li>
<li><p><strong>db</strong> – On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span class="std std-ref">hs_free_database()</span></a> function.</p></li>
<li><p><strong>error</strong> – If the compile fails, a pointer to a <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span class="std std-ref">hs_free_compile_error()</span></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span class="std std-ref">HS_COMPILER_ERROR</span></a> on failure, with details provided in the <code class="docutils literal notranslate"><span class="pre">error</span></code> parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_compile_lit">
<span class="target" id="hs__compile_8h_1a8706e8031f537f7f787f43240064288c"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compile_lit</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">expression</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t"><span class="n"><span class="pre">hs_platform_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">platform</span></span>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile_lit" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The basic pure literal expression compiler.</p>
<p>This is the function call with which a pure literal expression (not a common regular expression) is compiled into a Hyperscan database which can be passed to the runtime functions (such as <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a>, <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>, etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expression</strong> – The NULL-terminated expression to parse. Note that this string must represent ONLY the pattern to be matched, with no delimiters or flags; any global flags should be specified with the <code class="docutils literal notranslate"><span class="pre">flags</span></code> argument. For example, the expression <code class="docutils literal notranslate"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal notranslate"><span class="pre">abc?def</span></code> as the <code class="docutils literal notranslate"><span class="pre">expression</span></code>, and <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span class="std std-ref">HS_FLAG_CASELESS</span></a> as the <em>flags</em>. Meanwhile, the string content shall be fully parsed in a literal sense without any regular grammars. For example, the <code class="docutils literal notranslate"><span class="pre">expression</span></code> <code class="docutils literal notranslate"><span class="pre">abc?</span></code> simply means a char sequence of <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, and <code class="docutils literal notranslate"><span class="pre">?</span></code>. The <code class="docutils literal notranslate"><span class="pre">?</span></code> here doesn’t mean 0 or 1 quantifier under regular semantics.</p></li>
<li><p><strong>flags</strong> – Flags which modify the behaviour of the expression. Multiple flags may be used by ORing them together. Compared to <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, fewer valid values are provided:<ul>
<li><p>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</p></li>
<li><p>HS_FLAG_SINGLEMATCH - Only one match will be generated for the expression per stream.</p></li>
<li><p>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</p></li>
</ul>
</p></li>
<li><p><strong>len</strong> – The length of the text content of the pure literal expression. As the text content indicated by <code class="docutils literal notranslate"><span class="pre">expression</span></code> is treated as single character one by one, the special terminating character <code class="docutils literal notranslate"><span class="pre">\0</span></code> should be allowed to appear in expression, and not treated as a terminator for a string. Thus, the end of a pure literal expression cannot be indicated by identifying <code class="docutils literal notranslate"><span class="pre">\0</span></code>, but by counting to the expression length.</p></li>
<li><p><strong>mode</strong> – Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span class="std std-ref">HS_MODE_STREAM</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span class="std std-ref">HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span class="std std-ref">HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p></li>
<li><p><strong>platform</strong> – If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p></li>
<li><p><strong>db</strong> – On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span class="std std-ref">hs_free_database()</span></a> function.</p></li>
<li><p><strong>error</strong> – If the compile fails, a pointer to a <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span class="std std-ref">hs_free_compile_error()</span></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span class="std std-ref">HS_COMPILER_ERROR</span></a> on failure, with details provided in the error parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_compile_lit_multi">
<span class="target" id="hs__compile_8h_1a5791968e50a4ae51cbb909b6f3a6f608"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compile_lit_multi</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">expressions</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ids</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">lens</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="n"><span class="pre">elements</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t"><span class="n"><span class="pre">hs_platform_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">platform</span></span>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile_lit_multi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The multiple pure literal expression compiler.</p>
<p>This is the function call with which a set of pure literal expressions is compiled into a database which can be passed to the runtime functions (such as <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a>, <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>, etc.) Each expression can be labelled with a unique integer which is passed into the match callback to identify the pattern that has matched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expressions</strong> – The NULL-terminated expression to parse. Note that this string must represent ONLY the pattern to be matched, with no delimiters or flags; any global flags should be specified with the <code class="docutils literal notranslate"><span class="pre">flags</span></code> argument. For example, the expression <code class="docutils literal notranslate"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal notranslate"><span class="pre">abc?def</span></code> as the <code class="docutils literal notranslate"><span class="pre">expression</span></code>, and <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span class="std std-ref">HS_FLAG_CASELESS</span></a> as the <em>flags</em>. Meanwhile, the string content shall be fully parsed in a literal sense without any regular grammars. For example, the <code class="docutils literal notranslate"><span class="pre">expression</span></code> <code class="docutils literal notranslate"><span class="pre">abc?</span></code> simply means a char sequence of <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, and <code class="docutils literal notranslate"><span class="pre">?</span></code>. The <code class="docutils literal notranslate"><span class="pre">?</span></code> here doesn’t mean 0 or 1 quantifier under regular semantics.</p></li>
<li><p><strong>flags</strong> – Array of flags which modify the behaviour of each expression. Multiple flags may be used by ORing them together. Specifying the NULL pointer in place of an array will set the flags value for all patterns to zero. Compared to <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a>, fewer valid values are provided:<ul>
<li><p>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</p></li>
<li><p>HS_FLAG_SINGLEMATCH - Only one match will be generated for the expression per stream.</p></li>
<li><p>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</p></li>
</ul>
</p></li>
<li><p><strong>ids</strong> – An array of integers specifying the ID number to be associated with the corresponding pattern in the expressions array. Specifying the NULL pointer in place of an array will set the ID value for all patterns to zero.</p></li>
<li><p><strong>lens</strong> – Array of lengths of the text content of each pure literal expression. As the text content indicated by <code class="docutils literal notranslate"><span class="pre">expression</span></code> is treated as single character one by one, the special terminating character <code class="docutils literal notranslate"><span class="pre">\0</span></code> should be allowed to appear in expression, and not treated as a terminator for a string. Thus, the end of a pure literal expression cannot be indicated by identifying <code class="docutils literal notranslate"><span class="pre">\0</span></code>, but by counting to the expression length.</p></li>
<li><p><strong>elements</strong> – The number of elements in the input arrays.</p></li>
<li><p><strong>mode</strong> – Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span class="std std-ref">HS_MODE_STREAM</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span class="std std-ref">HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span class="std std-ref">HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p></li>
<li><p><strong>platform</strong> – If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p></li>
<li><p><strong>db</strong> – On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span class="std std-ref">hs_free_database()</span></a> function.</p></li>
<li><p><strong>error</strong> – If the compile fails, a pointer to a <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span class="std std-ref">hs_free_compile_error()</span></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span class="std std-ref">HS_COMPILER_ERROR</span></a> on failure, with details provided in the error parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_free_compile_error">
<span class="target" id="hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_free_compile_error</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_free_compile_error" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free an error structure generated by <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a> or <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error</strong> – The <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> to be freed. NULL may also be safely provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_expression_info">
<span class="target" id="hs__compile_8h_1a414dfeeb4fee8d2444b531cef4bed0a4"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_expression_info</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">expression</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <a class="reference internal" href="#c.hs_expr_info_t" title="hs_expr_info_t"><span class="n"><span class="pre">hs_expr_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">info</span></span>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_expression_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Utility function providing information about a regular expression. The information provided in <a class="reference internal" href="#hs__compile_8h_1ab299ce60736a43eca45e34d2eaf2462f"><span class="std std-ref">hs_expr_info_t</span></a> includes the minimum and maximum width of a pattern match.</p>
<p>Note: successful analysis of an expression with this function does not imply that compilation of the same expression (via <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a> or <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>) would succeed. This function may return <a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> for regular expressions that Hyperscan cannot compile.</p>
<p>Note: some per-pattern flags (such as <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"><span class="std std-ref">HS_FLAG_ALLOWEMPTY</span></a>, <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span class="std std-ref">HS_FLAG_SOM_LEFTMOST</span></a>) are accepted by this call, but as they do not affect the properties returned in the <a class="reference internal" href="#hs__compile_8h_1ab299ce60736a43eca45e34d2eaf2462f"><span class="std std-ref">hs_expr_info_t</span></a> structure, they will not affect the outcome of this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expression</strong> – The NULL-terminated expression to parse. Note that this string must represent ONLY the pattern to be matched, with no delimiters or flags; any global flags should be specified with the <code class="docutils literal notranslate"><span class="pre">flags</span></code> argument. For example, the expression <code class="docutils literal notranslate"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal notranslate"><span class="pre">abc?def</span></code> as the <code class="docutils literal notranslate"><span class="pre">expression</span></code>, and <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span class="std std-ref">HS_FLAG_CASELESS</span></a> as the <em>flags</em>.</p></li>
<li><p><strong>flags</strong> – Flags which modify the behaviour of the expression. Multiple flags may be used by ORing them together. Valid values are:<ul>
<li><p>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</p></li>
<li><p>HS_FLAG_DOTALL - Matching a <code class="docutils literal notranslate"><span class="pre">.</span></code> will not exclude newlines.</p></li>
<li><p>HS_FLAG_MULTILINE - <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> anchors match any newlines in data.</p></li>
<li><p>HS_FLAG_SINGLEMATCH - Only one match will be generated by the expression per stream.</p></li>
<li><p>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</p></li>
<li><p>HS_FLAG_UCP - Use Unicode properties for character classes.</p></li>
<li><p>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</p></li>
<li><p>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</p></li>
<li><p>HS_FLAG_QUIET - This flag will be ignored.</p></li>
</ul>
</p></li>
<li><p><strong>info</strong> – On success, a pointer to the pattern information will be returned in this parameter, or NULL on failure. This structure is allocated using the allocator supplied in <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a> (or malloc() if no allocator was set) and should be freed by the caller.</p></li>
<li><p><strong>error</strong> – If the call fails, a pointer to a <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span class="std std-ref">hs_free_compile_error()</span></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span class="std std-ref">HS_COMPILER_ERROR</span></a> on failure, with details provided in the error parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_expression_ext_info">
<span class="target" id="hs__compile_8h_1a007328330e6e0abbb4be5422015384b7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_expression_ext_info</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">expression</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_expr_ext_t" title="hs_expr_ext_t"><span class="n"><span class="pre">hs_expr_ext_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ext</span></span>, <a class="reference internal" href="#c.hs_expr_info_t" title="hs_expr_info_t"><span class="n"><span class="pre">hs_expr_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">info</span></span>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t"><span class="n"><span class="pre">hs_compile_error_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_expression_ext_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Utility function providing information about a regular expression, with extended parameter support. The information provided in <a class="reference internal" href="#hs__compile_8h_1ab299ce60736a43eca45e34d2eaf2462f"><span class="std std-ref">hs_expr_info_t</span></a> includes the minimum and maximum width of a pattern match.</p>
<p>Note: successful analysis of an expression with this function does not imply that compilation of the same expression (via <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a> or <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>) would succeed. This function may return <a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> for regular expressions that Hyperscan cannot compile.</p>
<p>Note: some per-pattern flags (such as <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"><span class="std std-ref">HS_FLAG_ALLOWEMPTY</span></a>, <a class="reference internal" href="#group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span class="std std-ref">HS_FLAG_SOM_LEFTMOST</span></a>) are accepted by this call, but as they do not affect the properties returned in the <a class="reference internal" href="#hs__compile_8h_1ab299ce60736a43eca45e34d2eaf2462f"><span class="std std-ref">hs_expr_info_t</span></a> structure, they will not affect the outcome of this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expression</strong> – The NULL-terminated expression to parse. Note that this string must represent ONLY the pattern to be matched, with no delimiters or flags; any global flags should be specified with the <code class="docutils literal notranslate"><span class="pre">flags</span></code> argument. For example, the expression <code class="docutils literal notranslate"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal notranslate"><span class="pre">abc?def</span></code> as the <code class="docutils literal notranslate"><span class="pre">expression</span></code>, and <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span class="std std-ref">HS_FLAG_CASELESS</span></a> as the <em>flags</em>.</p></li>
<li><p><strong>flags</strong> – Flags which modify the behaviour of the expression. Multiple flags may be used by ORing them together. Valid values are:<ul>
<li><p>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</p></li>
<li><p>HS_FLAG_DOTALL - Matching a <code class="docutils literal notranslate"><span class="pre">.</span></code> will not exclude newlines.</p></li>
<li><p>HS_FLAG_MULTILINE - <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> anchors match any newlines in data.</p></li>
<li><p>HS_FLAG_SINGLEMATCH - Only one match will be generated by the expression per stream.</p></li>
<li><p>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</p></li>
<li><p>HS_FLAG_UCP - Use Unicode properties for character classes.</p></li>
<li><p>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</p></li>
<li><p>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</p></li>
<li><p>HS_FLAG_QUIET - This flag will be ignored.</p></li>
</ul>
</p></li>
<li><p><strong>ext</strong> – A pointer to a filled <a class="reference internal" href="#hs__compile_8h_1a5acd00a47f8519536b991df7d2f7be51"><span class="std std-ref">hs_expr_ext_t</span></a> structure that defines extended behaviour for this pattern. NULL may be specified if no extended parameters are needed.</p></li>
<li><p><strong>info</strong> – On success, a pointer to the pattern information will be returned in this parameter, or NULL on failure. This structure is allocated using the allocator supplied in <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a> (or malloc() if no allocator was set) and should be freed by the caller.</p></li>
<li><p><strong>error</strong> – If the call fails, a pointer to a <a class="reference internal" href="#hs__compile_8h_1ab4f83c142ee043433194628ca66e0391"><span class="std std-ref">hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span class="std std-ref">hs_free_compile_error()</span></a> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span class="std std-ref">HS_COMPILER_ERROR</span></a> on failure, with details provided in the error parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_populate_platform">
<span class="target" id="hs__compile_8h_1a7fba694199df776522bc959a43a0079c"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_populate_platform</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t"><span class="n"><span class="pre">hs_platform_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">platform</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_populate_platform" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Populates the platform information based on the current host.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>platform</strong> – On success, the pointed to structure is populated based on the current host.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.hs_compile_error">
<span class="target" id="strucths__compile__error"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compile_error</span></span></span><a class="headerlink" href="#c.hs_compile_error" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A type containing error details that is returned by the compile calls (<a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a> and <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>) on failure. The caller may inspect the values returned in this type to determine the cause of failure.</p>
<p>Common errors generated during the compile process include:</p>
<p><ul>
<li><p><em>Invalid parameter</em></p>
<p>An invalid argument was specified in the compile call.</p>
</li>
<li><p><em>Unrecognised flag</em></p>
<p>An unrecognised value was passed in the flags argument.</p>
</li>
<li><p><em>Pattern matches empty buffer</em></p>
<p>By default, Hyperscan only supports patterns that will <em>always</em> consume at least one byte of input. Patterns that do not have this property (such as <code class="docutils literal notranslate"><span class="pre">/(abc)?/</span></code>) will produce this error unless the <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"><span class="std std-ref">HS_FLAG_ALLOWEMPTY</span></a> flag is supplied. Note that such patterns will produce a match for <em>every</em> byte when scanned.</p>
</li>
<li><p><em>Embedded anchors not supported</em></p>
<p>Hyperscan only supports the use of anchor meta-characters (such as <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code>) in patterns where they could <em>only</em> match at the start or end of a buffer. A pattern containing an embedded anchor, such as <code class="docutils literal notranslate"><span class="pre">/abc^def/</span></code>, can never match, as there is no way for <code class="docutils literal notranslate"><span class="pre">abc</span></code> to precede the start of the data stream.</p>
</li>
<li><p><em>Bounded repeat is too large</em></p>
<p>The pattern contains a repeated construct with very large finite bounds.</p>
</li>
<li><p><em>Unsupported component type</em></p>
<p>An unsupported PCRE construct was used in the pattern.</p>
</li>
<li><p><em>Unable to generate bytecode</em></p>
<p>This error indicates that Hyperscan was unable to compile a pattern that is syntactically valid. The most common cause is a pattern that is very long and complex or contains a large repeated subpattern.</p>
</li>
<li><p><em>Unable to allocate memory</em></p>
<p>The library was unable to allocate temporary storage used during compilation time.</p>
</li>
<li><p><em>Allocator returned misaligned memory</em></p>
<p>The memory allocator (either malloc() or the allocator set with <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a>) did not correctly return memory suitably aligned for the largest representable data type on this platform.</p>
</li>
<li><p><em>Internal error</em></p>
<p>An unexpected error occurred: if this error is reported, please contact the Hyperscan team with a description of the situation. </p>
</li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.hs_compile_error.message">
<span class="target" id="strucths__compile__error_1a303cf95a1eec5a9fc3edae048cd85fbf"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">message</span></span></span><a class="headerlink" href="#c.hs_compile_error.message" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A human-readable error message describing the error. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_compile_error.expression">
<span class="target" id="strucths__compile__error_1afd4362e387e24e5328277719383f055a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">expression</span></span></span><a class="headerlink" href="#c.hs_compile_error.expression" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The zero-based number of the expression that caused the error (if this can be determined). If the error is not specific to an expression, then this value will be less than zero. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.hs_platform_info">
<span class="target" id="strucths__platform__info"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_platform_info</span></span></span><a class="headerlink" href="#c.hs_platform_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A type containing information on the target platform which may optionally be provided to the compile calls (<a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, <a class="reference internal" href="#hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span class="std std-ref">hs_compile_multi()</span></a>, <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a>).</p>
<p>A <a class="reference internal" href="#strucths__platform__info"><span class="std std-ref">hs_platform_info</span></a> structure may be populated for the current platform by using the <a class="reference internal" href="#hs__compile_8h_1a7fba694199df776522bc959a43a0079c"><span class="std std-ref">hs_populate_platform()</span></a> call. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.hs_platform_info.tune">
<span class="target" id="strucths__platform__info_1a8561393042c07099d545e03fda5512b7"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tune</span></span></span><a class="headerlink" href="#c.hs_platform_info.tune" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Information about the target platform which may be used to guide the optimisation process of the compile.</p>
<p>Use of this field does not limit the processors that the resulting database can run on, but may impact the performance of the resulting database. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_platform_info.cpu_features">
<span class="target" id="strucths__platform__info_1a29ad1841b85ee32b720e18c53f37450d"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cpu_features</span></span></span><a class="headerlink" href="#c.hs_platform_info.cpu_features" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Relevant CPU features available on the target platform</p>
<p>This value may be produced by combining HS_CPU_FEATURE_* flags (such as <a class="reference internal" href="#group__HS__CPU__FEATURES__FLAG_1ga1ae675026897399f27c610251b5f14a1"><span class="std std-ref">HS_CPU_FEATURES_AVX2</span></a>). Multiple CPU features may be or’ed together to produce the value. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_platform_info.reserved1">
<span class="target" id="strucths__platform__info_1a750e5d9803c909ecfa8109eacc1f37a2"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reserved1</span></span></span><a class="headerlink" href="#c.hs_platform_info.reserved1" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reserved for future use. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_platform_info.reserved2">
<span class="target" id="strucths__platform__info_1aec8841304b85f2ca488482ab47eae42b"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reserved2</span></span></span><a class="headerlink" href="#c.hs_platform_info.reserved2" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reserved for future use. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.hs_expr_info">
<span class="target" id="strucths__expr__info"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_expr_info</span></span></span><a class="headerlink" href="#c.hs_expr_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A type containing information related to an expression that is returned by <a class="reference internal" href="#hs__compile_8h_1a414dfeeb4fee8d2444b531cef4bed0a4"><span class="std std-ref">hs_expression_info()</span></a> or <a class="reference internal" href="#hs__compile_8h_1a007328330e6e0abbb4be5422015384b7"><span class="std std-ref">hs_expression_ext_info</span></a>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_info.min_width">
<span class="target" id="strucths__expr__info_1ae3988283e676fd604d3fd8f4b7f3958c"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">min_width</span></span></span><a class="headerlink" href="#c.hs_expr_info.min_width" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The minimum length in bytes of a match for the pattern.</p>
<p>Note: in some cases when using advanced features to suppress matches (such as extended parameters or the <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"><span class="std std-ref">HS_FLAG_SINGLEMATCH</span></a> flag) this may represent a conservative lower bound for the true minimum length of a match. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_info.max_width">
<span class="target" id="strucths__expr__info_1ae728af1e67caaa6691e6bc4e8954bfec"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">max_width</span></span></span><a class="headerlink" href="#c.hs_expr_info.max_width" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The maximum length in bytes of a match for the pattern. If the pattern has an unbounded maximum length, this will be set to the maximum value of an unsigned int (UINT_MAX).</p>
<p>Note: in some cases when using advanced features to suppress matches (such as extended parameters or the <a class="reference internal" href="#group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"><span class="std std-ref">HS_FLAG_SINGLEMATCH</span></a> flag) this may represent a conservative upper bound for the true maximum length of a match. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_info.unordered_matches">
<span class="target" id="strucths__expr__info_1ac19e2d22f86520ba745259df5fa22ec0"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">unordered_matches</span></span></span><a class="headerlink" href="#c.hs_expr_info.unordered_matches" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether this expression can produce matches that are not returned in order, such as those produced by assertions. Zero if false, non-zero if true. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_info.matches_at_eod">
<span class="target" id="strucths__expr__info_1a050ce501ddfe9c67af0f271dc1f9a24c"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matches_at_eod</span></span></span><a class="headerlink" href="#c.hs_expr_info.matches_at_eod" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether this expression can produce matches at end of data (EOD). In streaming mode, EOD matches are raised during <a class="reference internal" href="#hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span class="std std-ref">hs_close_stream()</span></a>, since it is only when <a class="reference internal" href="#hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span class="std std-ref">hs_close_stream()</span></a> is called that the EOD location is known. Zero if false, non-zero if true.</p>
<p>Note: trailing <code class="docutils literal notranslate"><span class="pre">\b</span></code> word boundary assertions may also result in EOD matches as end-of-data can act as a word boundary. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_info.matches_only_at_eod">
<span class="target" id="strucths__expr__info_1a063c18ce23ccc7a7c4222e52ad8ad314"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matches_only_at_eod</span></span></span><a class="headerlink" href="#c.hs_expr_info.matches_only_at_eod" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether this expression can <em>only</em> produce matches at end of data (EOD). In streaming mode, all matches for this expression are raised during <a class="reference internal" href="#hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span class="std std-ref">hs_close_stream()</span></a>. Zero if false, non-zero if true. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.hs_expr_ext">
<span class="target" id="strucths__expr__ext"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_expr_ext</span></span></span><a class="headerlink" href="#c.hs_expr_ext" title="Permalink to this definition">¶</a><br /></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A structure containing additional parameters related to an expression, passed in at build time to <a class="reference internal" href="#hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span class="std std-ref">hs_compile_ext_multi()</span></a> or <a class="reference internal" href="#hs__compile_8h_1a007328330e6e0abbb4be5422015384b7"><span class="std std-ref">hs_expression_ext_info</span></a>.</p>
<p>These parameters allow the set of matches produced by a pattern to be constrained at compile time, rather than relying on the application to process unwanted matches at runtime. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_ext.flags">
<span class="target" id="strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.hs_expr_ext.flags" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Flags governing which parts of this structure are to be used by the compiler. See hs_expr_ext_t flags. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_ext.min_offset">
<span class="target" id="strucths__expr__ext_1a006843974cb05dbf16291da621a72fa9"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">min_offset</span></span></span><a class="headerlink" href="#c.hs_expr_ext.min_offset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The minimum end offset in the data stream at which this expression should match successfully. To use this parameter, set the <a class="reference internal" href="#group__HS__EXT__FLAG_1ga8876e1c519442ec4feb47508e03a6c52"><span class="std std-ref">HS_EXT_FLAG_MIN_OFFSET</span></a> flag in the <a class="reference internal" href="#strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span class="std std-ref">hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_ext.max_offset">
<span class="target" id="strucths__expr__ext_1a263c613f20c6b8ef30ca01785e0f55fc"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">max_offset</span></span></span><a class="headerlink" href="#c.hs_expr_ext.max_offset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The maximum end offset in the data stream at which this expression should match successfully. To use this parameter, set the <a class="reference internal" href="#group__HS__EXT__FLAG_1ga7f68e1f3b5ad7c39165e56f294aab5f8"><span class="std std-ref">HS_EXT_FLAG_MAX_OFFSET</span></a> flag in the <a class="reference internal" href="#strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span class="std std-ref">hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_ext.min_length">
<span class="target" id="strucths__expr__ext_1a6afdac1e0bb89d9a76d6c91ed86a6fe8"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">min_length</span></span></span><a class="headerlink" href="#c.hs_expr_ext.min_length" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The minimum match length (from start to end) required to successfully match this expression. To use this parameter, set the <a class="reference internal" href="#group__HS__EXT__FLAG_1ga08b4bfb7f87b2f768c470ede24a724b6"><span class="std std-ref">HS_EXT_FLAG_MIN_LENGTH</span></a> flag in the <a class="reference internal" href="#strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span class="std std-ref">hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_ext.edit_distance">
<span class="target" id="strucths__expr__ext_1a8b7536c6ca0b01faa975b195e04b3913"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">edit_distance</span></span></span><a class="headerlink" href="#c.hs_expr_ext.edit_distance" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allow patterns to approximately match within this edit distance. To use this parameter, set the <a class="reference internal" href="#group__HS__EXT__FLAG_1gac557ac5c1da1649b151ac435ea56d41c"><span class="std std-ref">HS_EXT_FLAG_EDIT_DISTANCE</span></a> flag in the <a class="reference internal" href="#strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span class="std std-ref">hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.hs_expr_ext.hamming_distance">
<span class="target" id="strucths__expr__ext_1a94072afd1400402fad2e59c6dbdb7973"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hamming_distance</span></span></span><a class="headerlink" href="#c.hs_expr_ext.hamming_distance" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allow patterns to approximately match within this Hamming distance. To use this parameter, set the <a class="reference internal" href="#group__HS__EXT__FLAG_1ga0568165f31e3bf0ece0e4466840ca466"><span class="std std-ref">HS_EXT_FLAG_HAMMING_DISTANCE</span></a> flag in the <a class="reference internal" href="#strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span class="std std-ref">hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="file-hs-runtime-h">
<h2>File: hs_runtime.h<a class="headerlink" href="#file-hs-runtime-h" title="Permalink to this heading">¶</a></h2>
<p>The Hyperscan runtime API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header contains functions for using compiled Hyperscan databases for scanning data at runtime. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.HS_OFFSET_PAST_HORIZON">
<span class="target" id="hs__runtime_8h_1a5a2035b99ba414e593a41b41a5f41a36"></span><span class="sig-name descname"><span class="n"><span class="pre">HS_OFFSET_PAST_HORIZON</span></span></span><a class="headerlink" href="#c.HS_OFFSET_PAST_HORIZON" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Callback ‘from’ return value, indicating that the start of this match was too early to be tracked with the requested SOM_HORIZON precision. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.hs_stream_t">
<span class="target" id="hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">hs_stream</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_stream_t</span></span></span><a class="headerlink" href="#c.hs_stream_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The stream identifier returned by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>. </p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.hs_scratch_t">
<span class="target" id="hs__runtime_8h_1af0a89aeb8f5256f35c0bc86e8ca2a19b"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">hs_scratch</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_scratch_t</span></span></span><a class="headerlink" href="#c.hs_scratch_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A Hyperscan scratch space. </p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.match_event_handler">
<span class="target" id="hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">match_event_handler</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n"><span class="pre">from</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n"><span class="pre">to</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.match_event_handler" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Definition of the match event callback function type.</p>
<p>A callback function matching the defined type must be provided by the application calling the <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a>, <a class="reference internal" href="#hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"><span class="std std-ref">hs_scan_vector()</span></a> or <a class="reference internal" href="#hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"><span class="std std-ref">hs_scan_stream()</span></a> functions (or other streaming calls which can produce matches).</p>
<p>This callback function will be invoked whenever a match is located in the target data during the execution of a scan. The details of the match are passed in as parameters to the callback function, and the callback function should return a value indicating whether or not matching should continue on the target data. If no callbacks are desired from a scan call, NULL may be provided in order to suppress match production.</p>
<p>This callback function should not attempt to call Hyperscan API functions on the same stream nor should it attempt to reuse the scratch space allocated for the API calls that caused it to be triggered. Making another call to the Hyperscan library with completely independent parameters should work (for example, scanning a different database in a new stream and with new scratch space), but reusing data structures like stream state and/or scratch space will produce undefined behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Param id</dt>
<dd class="field-odd"><p>The ID number of the expression that matched. If the expression was a single expression compiled with <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>, this value will be zero.</p>
</dd>
<dt class="field-even">Param from</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>If a start of match flag is enabled for the current pattern, this argument will be set to the start of match for the pattern assuming that that start of match value lies within the current ‘start of match horizon’ chosen by one of the SOM_HORIZON mode flags.</p></li>
<li><p>If the start of match value lies outside this horizon (possible only when the SOM_HORIZON value is not <a class="reference internal" href="#group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"><span class="std std-ref">HS_MODE_SOM_HORIZON_LARGE</span></a>), the <code class="docutils literal notranslate"><span class="pre">from</span></code> value will be set to <a class="reference internal" href="#hs__runtime_8h_1a5a2035b99ba414e593a41b41a5f41a36"><span class="std std-ref">HS_OFFSET_PAST_HORIZON</span></a>.</p></li>
<li><p>This argument will be set to zero if the Start of Match flag is not enabled for the given pattern.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Param to</dt>
<dd class="field-odd"><p>The offset after the last byte that matches the expression.</p>
</dd>
<dt class="field-even">Param flags</dt>
<dd class="field-even"><p>This is provided for future use and is unused at present.</p>
</dd>
<dt class="field-odd">Param context</dt>
<dd class="field-odd"><p>The pointer supplied by the user to the <a class="reference internal" href="#hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span class="std std-ref">hs_scan()</span></a>, <a class="reference internal" href="#hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"><span class="std std-ref">hs_scan_vector()</span></a> or <a class="reference internal" href="#hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"><span class="std std-ref">hs_scan_stream()</span></a> function.</p>
</dd>
<dt class="field-even">Return</dt>
<dd class="field-even"><p>Non-zero if the matching should cease, else zero. If scanning is performed in streaming mode and a non-zero value is returned, any subsequent calls to <a class="reference internal" href="#hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"><span class="std std-ref">hs_scan_stream()</span></a> for that stream will immediately return with <a class="reference internal" href="#group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span class="std std-ref">HS_SCAN_TERMINATED</span></a>. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.hs_open_stream">
<span class="target" id="hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_open_stream</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_open_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Open and initialise a stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – A compiled pattern database.</p></li>
<li><p><strong>flags</strong> – Flags modifying the behaviour of the stream. This parameter is provided for future use and is unused at present.</p></li>
<li><p><strong>stream</strong> – On success, a pointer to the generated <a class="reference internal" href="#hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span class="std std-ref">hs_stream_t</span></a> will be returned; NULL on failure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_scan_stream">
<span class="target" id="hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_scan_stream</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler"><span class="n"><span class="pre">match_event_handler</span></span></a><span class="w"> </span><span class="n"><span class="pre">onEvent</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctxt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scan_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Write data to be scanned to the opened stream.</p>
<p>This is the function call in which the actual pattern matching takes place as data is written to the stream. Matches will be returned via the <a class="reference internal" href="#hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span class="std std-ref">match_event_handler</span></a> callback supplied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – The stream ID (returned by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>) to which the data will be written.</p></li>
<li><p><strong>data</strong> – Pointer to the data to be scanned.</p></li>
<li><p><strong>length</strong> – The number of bytes to scan.</p></li>
<li><p><strong>flags</strong> – Flags modifying the behaviour of the stream. This parameter is provided for future use and is unused at present.</p></li>
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a>.</p></li>
<li><p><strong>onEvent</strong> – Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p></li>
<li><p><strong>ctxt</strong> – The user defined pointer which will be passed to the callback function when a match occurs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns <a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success; <a class="reference internal" href="#group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span class="std std-ref">HS_SCAN_TERMINATED</span></a> if the match callback indicated that scanning should stop; other values on error. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_close_stream">
<span class="target" id="hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_close_stream</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler"><span class="n"><span class="pre">match_event_handler</span></span></a><span class="w"> </span><span class="n"><span class="pre">onEvent</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctxt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_close_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Close a stream.</p>
<p>This function completes matching on the given stream and frees the memory associated with the stream state. After this call, the stream pointed to by <code class="docutils literal notranslate"><span class="pre">id</span></code> is invalid and can no longer be used. To reuse the stream state after completion, rather than closing it, the <a class="reference internal" href="#hs__runtime_8h_1a6d7d40908655b373fe73f872a48cf853"><span class="std std-ref">hs_reset_stream</span></a> function can be used.</p>
<p>This function must be called for any stream created with <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>, even if scanning has been terminated by a non-zero return from the match callback function.</p>
<p>Note: This operation may result in matches being returned (via calls to the match event callback) for expressions anchored to the end of the data stream (for example, via the use of the <code class="docutils literal notranslate"><span class="pre">$</span></code> meta-character). If these matches are not desired, NULL may be provided as the <a class="reference internal" href="#hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span class="std std-ref">match_event_handler</span></a> callback.</p>
<p>If NULL is provided as the <a class="reference internal" href="#hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span class="std std-ref">match_event_handler</span></a> callback, it is permissible to provide a NULL scratch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – The stream ID returned by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>.</p></li>
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a>. This is allowed to be NULL only if the <code class="docutils literal notranslate"><span class="pre">onEvent</span></code> callback is also NULL.</p></li>
<li><p><strong>onEvent</strong> – Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p></li>
<li><p><strong>ctxt</strong> – The user defined pointer which will be passed to the callback function when a match occurs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns <a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_reset_stream">
<span class="target" id="hs__runtime_8h_1a6d7d40908655b373fe73f872a48cf853"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_reset_stream</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler"><span class="n"><span class="pre">match_event_handler</span></span></a><span class="w"> </span><span class="n"><span class="pre">onEvent</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">context</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_reset_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reset a stream to an initial state.</p>
<p>Conceptually, this is equivalent to performing <a class="reference internal" href="#hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span class="std std-ref">hs_close_stream()</span></a> on the given stream, followed by a <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>. This new stream replaces the original stream in memory, avoiding the overhead of freeing the old stream and allocating the new one.</p>
<p>Note: This operation may result in matches being returned (via calls to the match event callback) for expressions anchored to the end of the original data stream (for example, via the use of the <code class="docutils literal notranslate"><span class="pre">$</span></code> meta-character). If these matches are not desired, NULL may be provided as the <a class="reference internal" href="#hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span class="std std-ref">match_event_handler</span></a> callback.</p>
<p>Note: the stream will also be tied to the same database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – The stream (as created by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>) to be replaced.</p></li>
<li><p><strong>flags</strong> – Flags modifying the behaviour of the stream. This parameter is provided for future use and is unused at present.</p></li>
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a>. This is allowed to be NULL only if the <code class="docutils literal notranslate"><span class="pre">onEvent</span></code> callback is also NULL.</p></li>
<li><p><strong>onEvent</strong> – Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p></li>
<li><p><strong>context</strong> – The user defined pointer which will be passed to the callback function when a match occurs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_copy_stream">
<span class="target" id="hs__runtime_8h_1aac55833886321253c531331901f729b1"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_copy_stream</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">to_id</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">from_id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_copy_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Duplicate the given stream. The new stream will have the same state as the original including the current stream offset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_id</strong> – On success, a pointer to the new, copied <a class="reference internal" href="#hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span class="std std-ref">hs_stream_t</span></a> will be returned; NULL on failure.</p></li>
<li><p><strong>from_id</strong> – The stream (as created by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>) to be copied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_reset_and_copy_stream">
<span class="target" id="hs__runtime_8h_1a35a1dc0df0262b4b5f7afe0ca5266831"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_reset_and_copy_stream</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">to_id</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">from_id</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler"><span class="n"><span class="pre">match_event_handler</span></span></a><span class="w"> </span><span class="n"><span class="pre">onEvent</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">context</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_reset_and_copy_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Duplicate the given ‘from’ stream state onto the ‘to’ stream. The ‘to’ stream will first be reset (reporting any EOD matches if a non-NULL <code class="docutils literal notranslate"><span class="pre">onEvent</span></code> callback handler is provided).</p>
<p>Note: the ‘to’ stream and the ‘from’ stream must be open against the same database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_id</strong> – On success, a pointer to the new, copied <a class="reference internal" href="#hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span class="std std-ref">hs_stream_t</span></a> will be returned; NULL on failure.</p></li>
<li><p><strong>from_id</strong> – The stream (as created by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>) to be copied.</p></li>
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a>. This is allowed to be NULL only if the <code class="docutils literal notranslate"><span class="pre">onEvent</span></code> callback is also NULL.</p></li>
<li><p><strong>onEvent</strong> – Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p></li>
<li><p><strong>context</strong> – The user defined pointer which will be passed to the callback function when a match occurs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_compress_stream">
<span class="target" id="hs__runtime_8h_1a53160019137a88b32f25031b3f9d445b"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_compress_stream</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stream</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">buf_space</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">used_space</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compress_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Creates a compressed representation of the provided stream in the buffer provided. This compressed representation can be converted back into a stream state by using <a class="reference internal" href="#hs__runtime_8h_1a24799338f5ede76df9037b748d9de2ea"><span class="std std-ref">hs_expand_stream()</span></a> or <a class="reference internal" href="#hs__runtime_8h_1a8af7e7c46d929b65f028b2efd444acd7"><span class="std std-ref">hs_reset_and_expand_stream()</span></a>. The size of the compressed representation will be placed into <code class="docutils literal notranslate"><span class="pre">used_space</span></code>.</p>
<p>If there is not sufficient space in the buffer to hold the compressed representation, <a class="reference internal" href="#group__HS__ERROR_1ga5cda332b921d1f8022bdb4454047a815"><span class="std std-ref">HS_INSUFFICIENT_SPACE</span></a> will be returned and <code class="docutils literal notranslate"><span class="pre">used_space</span></code> will be populated with the amount of space required.</p>
<p>Note: this function does not close the provided stream, you may continue to use the stream or to free it with <a class="reference internal" href="#hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span class="std std-ref">hs_close_stream()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> – The stream (as created by <a class="reference internal" href="#hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span class="std std-ref">hs_open_stream()</span></a>) to be compressed.</p></li>
<li><p><strong>buf</strong> – Buffer to write the compressed representation into. Note: if the call is just being used to determine the amount of space required, it is allowed to pass NULL here and <code class="docutils literal notranslate"><span class="pre">buf_space</span></code> as 0.</p></li>
<li><p><strong>buf_space</strong> – The number of bytes in <code class="docutils literal notranslate"><span class="pre">buf</span></code>. If buf_space is too small, the call will fail with <a class="reference internal" href="#group__HS__ERROR_1ga5cda332b921d1f8022bdb4454047a815"><span class="std std-ref">HS_INSUFFICIENT_SPACE</span></a>.</p></li>
<li><p><strong>used_space</strong> – Pointer to where the amount of used space will be written to. The used buffer space is always less than or equal to <code class="docutils literal notranslate"><span class="pre">buf_space</span></code>. If the call fails with <a class="reference internal" href="#group__HS__ERROR_1ga5cda332b921d1f8022bdb4454047a815"><span class="std std-ref">HS_INSUFFICIENT_SPACE</span></a>, this pointer will be used to write out the amount of buffer space required.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, <a class="reference internal" href="#group__HS__ERROR_1ga5cda332b921d1f8022bdb4454047a815"><span class="std std-ref">HS_INSUFFICIENT_SPACE</span></a> if the provided buffer is too small. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_expand_stream">
<span class="target" id="hs__runtime_8h_1a24799338f5ede76df9037b748d9de2ea"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_expand_stream</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stream</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">buf_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_expand_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decompresses a compressed representation created by <a class="reference internal" href="#hs__runtime_8h_1a53160019137a88b32f25031b3f9d445b"><span class="std std-ref">hs_compress_stream()</span></a> into a new stream.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">buf</span></code> must correspond to a complete compressed representation created by <a class="reference internal" href="#hs__runtime_8h_1a53160019137a88b32f25031b3f9d445b"><span class="std std-ref">hs_compress_stream()</span></a> of a stream that was opened against <code class="docutils literal notranslate"><span class="pre">db</span></code>. It is not always possible to detect misuse of this API and behaviour is undefined if these properties are not satisfied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – The compiled pattern database that the compressed stream was opened against.</p></li>
<li><p><strong>stream</strong> – On success, a pointer to the expanded <a class="reference internal" href="#hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span class="std std-ref">hs_stream_t</span></a> will be returned; NULL on failure.</p></li>
<li><p><strong>buf</strong> – A compressed representation of a stream. These compressed forms are created by <a class="reference internal" href="#hs__runtime_8h_1a53160019137a88b32f25031b3f9d445b"><span class="std std-ref">hs_compress_stream()</span></a>.</p></li>
<li><p><strong>buf_size</strong> – The size in bytes of the compressed representation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_reset_and_expand_stream">
<span class="target" id="hs__runtime_8h_1a8af7e7c46d929b65f028b2efd444acd7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_reset_and_expand_stream</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t"><span class="n"><span class="pre">hs_stream_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">to_stream</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">buf_size</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler"><span class="n"><span class="pre">match_event_handler</span></span></a><span class="w"> </span><span class="n"><span class="pre">onEvent</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">context</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_reset_and_expand_stream" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decompresses a compressed representation created by <a class="reference internal" href="#hs__runtime_8h_1a53160019137a88b32f25031b3f9d445b"><span class="std std-ref">hs_compress_stream()</span></a> on top of the ‘to’ stream. The ‘to’ stream will first be reset (reporting any EOD matches if a non-NULL <code class="docutils literal notranslate"><span class="pre">onEvent</span></code> callback handler is provided).</p>
<p>Note: the ‘to’ stream must be opened against the same database as the compressed stream.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">buf</span></code> must correspond to a complete compressed representation created by <a class="reference internal" href="#hs__runtime_8h_1a53160019137a88b32f25031b3f9d445b"><span class="std std-ref">hs_compress_stream()</span></a> of a stream that was opened against <code class="docutils literal notranslate"><span class="pre">db</span></code>. It is not always possible to detect misuse of this API and behaviour is undefined if these properties are not satisfied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_stream</strong> – A pointer to a valid stream state. A pointer to the expanded <a class="reference internal" href="#hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span class="std std-ref">hs_stream_t</span></a> will be returned; NULL on failure.</p></li>
<li><p><strong>buf</strong> – A compressed representation of a stream. These compressed forms are created by <a class="reference internal" href="#hs__runtime_8h_1a53160019137a88b32f25031b3f9d445b"><span class="std std-ref">hs_compress_stream()</span></a>.</p></li>
<li><p><strong>buf_size</strong> – The size in bytes of the compressed representation.</p></li>
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a>. This is allowed to be NULL only if the <code class="docutils literal notranslate"><span class="pre">onEvent</span></code> callback is also NULL.</p></li>
<li><p><strong>onEvent</strong> – Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p></li>
<li><p><strong>context</strong> – The user defined pointer which will be passed to the callback function when a match occurs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_scan">
<span class="target" id="hs__runtime_8h_1a261656043947931ad9d826d158119e89"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_scan</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler"><span class="n"><span class="pre">match_event_handler</span></span></a><span class="w"> </span><span class="n"><span class="pre">onEvent</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">context</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scan" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The block (non-streaming) regular expression scanner.</p>
<p>This is the function call in which the actual pattern matching takes place for block-mode pattern databases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – A compiled pattern database.</p></li>
<li><p><strong>data</strong> – Pointer to the data to be scanned.</p></li>
<li><p><strong>length</strong> – The number of bytes to scan.</p></li>
<li><p><strong>flags</strong> – Flags modifying the behaviour of this function. This parameter is provided for future use and is unused at present.</p></li>
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a> for this database.</p></li>
<li><p><strong>onEvent</strong> – Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p></li>
<li><p><strong>context</strong> – The user defined pointer which will be passed to the callback function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns <a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success; <a class="reference internal" href="#group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span class="std std-ref">HS_SCAN_TERMINATED</span></a> if the match callback indicated that scanning should stop; other values on error. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_scan_vector">
<span class="target" id="hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_scan_vector</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">length</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">count</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler"><span class="n"><span class="pre">match_event_handler</span></span></a><span class="w"> </span><span class="n"><span class="pre">onEvent</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">context</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scan_vector" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The vectored regular expression scanner.</p>
<p>This is the function call in which the actual pattern matching takes place for vectoring-mode pattern databases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – A compiled pattern database.</p></li>
<li><p><strong>data</strong> – An array of pointers to the data blocks to be scanned.</p></li>
<li><p><strong>length</strong> – An array of lengths (in bytes) of each data block to scan.</p></li>
<li><p><strong>count</strong> – Number of data blocks to scan. This should correspond to the size of of the <code class="docutils literal notranslate"><span class="pre">data</span></code> and <code class="docutils literal notranslate"><span class="pre">length</span></code> arrays.</p></li>
<li><p><strong>flags</strong> – Flags modifying the behaviour of this function. This parameter is provided for future use and is unused at present.</p></li>
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a> for this database.</p></li>
<li><p><strong>onEvent</strong> – Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p></li>
<li><p><strong>context</strong> – The user defined pointer which will be passed to the callback function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns <a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success; <a class="reference internal" href="#group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span class="std std-ref">HS_SCAN_TERMINATED</span></a> if the match callback indicated that scanning should stop; other values on error. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_alloc_scratch">
<span class="target" id="hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_alloc_scratch</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t"><span class="n"><span class="pre">hs_database_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">db</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_alloc_scratch" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a “scratch” space for use by Hyperscan.</p>
<p>This is required for runtime use, and one scratch space per thread, or concurrent caller, is required. Any allocator callback set by <a class="reference internal" href="#hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span class="std std-ref">hs_set_scratch_allocator()</span></a> or <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a> will be used by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db</strong> – The database, as produced by <a class="reference internal" href="#hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span class="std std-ref">hs_compile()</span></a>.</p></li>
<li><p><strong>scratch</strong> – On first allocation, a pointer to NULL should be provided so a new scratch can be allocated. If a scratch block has been previously allocated, then a pointer to it should be passed back in to see if it is valid for this database block. If a new scratch block is required, the original will be freed and the new one returned, otherwise the previous scratch block will be returned. On success, the scratch block will be suitable for use with the provided database in addition to any databases that original scratch space was suitable for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on successful allocation; <a class="reference internal" href="#group__HS__ERROR_1ga209e23f064df891f66575950b383832c"><span class="std std-ref">HS_NOMEM</span></a> if the allocation fails. Other errors may be returned if invalid parameters are specified. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_clone_scratch">
<span class="target" id="hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_clone_scratch</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">src</span></span>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_clone_scratch" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a scratch space that is a clone of an existing scratch space.</p>
<p>This is useful when multiple concurrent threads will be using the same set of compiled databases, and another scratch space is required. Any allocator callback set by <a class="reference internal" href="#hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span class="std std-ref">hs_set_scratch_allocator()</span></a> or <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a> will be used by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> – The existing <a class="reference internal" href="#hs__runtime_8h_1af0a89aeb8f5256f35c0bc86e8ca2a19b"><span class="std std-ref">hs_scratch_t</span></a> to be cloned.</p></li>
<li><p><strong>dest</strong> – A pointer to the new scratch space will be returned here.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success; <a class="reference internal" href="#group__HS__ERROR_1ga209e23f064df891f66575950b383832c"><span class="std std-ref">HS_NOMEM</span></a> if the allocation fails. Other errors may be returned if invalid parameters are specified. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_scratch_size">
<span class="target" id="hs__runtime_8h_1a3d3b52dd640a76eaf2eb3280be452d78"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_scratch_size</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scratch_size" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Provides the size of the given scratch space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scratch</strong> – A per-thread scratch space allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a> or <a class="reference internal" href="#hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"><span class="std std-ref">hs_clone_scratch()</span></a>.</p></li>
<li><p><strong>scratch_size</strong> – On success, the size of the scratch space in bytes is placed in this parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.hs_free_scratch">
<span class="target" id="hs__runtime_8h_1ac662a5057cf5520531775fc2841b8c5b"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t"><span class="n"><span class="pre">hs_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hs_free_scratch</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t"><span class="n"><span class="pre">hs_scratch_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_free_scratch" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free a scratch block previously allocated by <a class="reference internal" href="#hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span class="std std-ref">hs_alloc_scratch()</span></a> or <a class="reference internal" href="#hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"><span class="std std-ref">hs_clone_scratch()</span></a>.</p>
<p>The free callback set by <a class="reference internal" href="#hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span class="std std-ref">hs_set_scratch_allocator()</span></a> or <a class="reference internal" href="#hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span class="std std-ref">hs_set_allocator()</span></a> will be used by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scratch</strong> – The scratch block to be freed. NULL may also be safely provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span class="std std-ref">HS_SUCCESS</span></a> on success, other values on failure. </p>
</dd>
</dl>
</dd></dl>

</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">Compiling Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Scanning for Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="serialization.html">Serialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_constants.html">API Reference: Constants</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference: Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-h">File: hs.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-common-h">File: hs_common.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-compile-h">File: hs_compile.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-runtime-h">File: hs_runtime.h</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chimera.html">Chimera</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015-2018, Intel Corporation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>