<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js snort-dark">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rules - Snort 3 Rule Writing Guide</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
        <link href="../css2?family=Nunito+Sans:ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "snort-dark" : "snort-dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('snort-dark')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../welcome.htm">Snort 3 Rule Writing Guide</a></li><li class="chapter-item expanded "><a href="../intro.htm">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Using Snort 3</li><li class="chapter-item expanded "><a href="index.htm">Getting Started with Snort 3</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="installation.htm">Installing Snort</a></li><li class="chapter-item expanded "><a href="running.htm">Using Snort</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="help.htm">Command Line Basics</a></li><li class="chapter-item expanded "><a href="inspection.htm">Reading Traffic</a></li><li class="chapter-item expanded "><a href="configuration.htm">Configuration</a></li><li class="chapter-item expanded "><a href="rules.htm" class="active">Rules</a></li><li class="chapter-item expanded "><a href="wizard_binder.htm">Wizard and Binder</a></li><li class="chapter-item expanded "><a href="tweaks_scripts.htm">Tweaks and Scripts</a></li><li class="chapter-item expanded "><a href="tracing.htm">Trace Modules</a></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">Writing Snort Rules</li><li class="chapter-item expanded "><a href="../rules/index.htm">The Basics</a></li><li class="chapter-item expanded "><a href="../rules/headers/index.htm">Rule Headers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/headers/actions.htm">Rule Actions</a></li><li class="chapter-item expanded "><a href="../rules/headers/protocols.htm">Protocols</a></li><li class="chapter-item expanded "><a href="../rules/headers/ips.htm">IP Addresses</a></li><li class="chapter-item expanded "><a href="../rules/headers/ports.htm">Port Numbers</a></li><li class="chapter-item expanded "><a href="../rules/headers/directions.htm">Direction Operators</a></li></ol></li><li class="chapter-item expanded "><a href="../rules/headers/new_header_types.htm">New Rule Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/headers/service_rules.htm">Service Rules</a></li><li class="chapter-item expanded "><a href="../rules/headers/file_rules.htm">File Rules</a></li><li class="chapter-item expanded "><a href="../rules/headers/file_id_rules.htm">File Identification Rules</a></li></ol></li><li class="chapter-item expanded "><a href="../rules/options/index.htm">Rule Options</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/options/key.htm">Rule Option Syntax Key</a></li><li class="chapter-item expanded "><a href="../rules/options/general/index.htm">General Rule Options</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/options/general/msg.htm">msg</a></li><li class="chapter-item expanded "><a href="../rules/options/general/reference.htm">reference</a></li><li class="chapter-item expanded "><a href="../rules/options/general/gid.htm">gid</a></li><li class="chapter-item expanded "><a href="../rules/options/general/sid.htm">sid</a></li><li class="chapter-item expanded "><a href="../rules/options/general/rev.htm">rev</a></li><li class="chapter-item expanded "><a href="../rules/options/general/classtype.htm">classtype</a></li><li class="chapter-item expanded "><a href="../rules/options/general/priority.htm">priority</a></li><li class="chapter-item expanded "><a href="../rules/options/general/metadata.htm">metadata</a></li><li class="chapter-item expanded "><a href="../rules/options/general/service.htm">service</a></li><li class="chapter-item expanded "><a href="../rules/options/general/rem.htm">rem</a></li><li class="chapter-item expanded "><a href="../rules/options/general/file_meta.htm">file_meta</a></li></ol></li><li class="chapter-item expanded "><a href="../rules/options/payload/index.htm">Payload Detection Rule Options</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/options/payload/content.htm">content</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/fast_pattern.htm">fast_pattern</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/nocase.htm">nocase</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/oddw.htm">offset, depth, distance, and within</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/index.htm">HTTP Specific Options</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/options/payload/http/uri.htm">http_uri and http_raw_uri</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/header.htm">http_header and http_raw_header</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/cookie.htm">http_cookie and http_raw_cookie</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/body.htm">http_client_body and http_raw_body</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/param.htm">http_param</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/method.htm">http_method</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/version.htm">http_version</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/stat_code.htm">http_stat_code</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/stat_msg.htm">http_stat_msg</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/raw_req-raw_status.htm">http_raw_request and http_raw_status</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/trailer.htm">http_trailer and http_raw_trailer</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/true_ip.htm">http_true_ip</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/version_match.htm">http_version_match</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/num_headers.htm">http_num_headers</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/num_trailers.htm">http_num_trailers</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/num_cookies.htm">http_num_cookies</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/header_test.htm">http_header_test</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/trailer_test.htm">http_trailer_test</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/http/req_resp_detection.htm">Combining Request and Response Detection</a></li></ol></li><li class="chapter-item expanded "><a href="../rules/options/payload/bufferlen.htm">bufferlen</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/isdataat.htm">isdataat</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/dsize.htm">dsize</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/pcre.htm">pcre</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/regex.htm">regex</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/pkt_data.htm">pkt_data</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/raw_data.htm">raw_data</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/file_data.htm">file_data</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/js_data.htm">js_data</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/vba_data.htm">vba_data</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/base64.htm">base64_decode and base64_data</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/byte_extract.htm">byte_extract</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/byte_test.htm">byte_test</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/byte_math.htm">byte_math</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/byte_jump.htm">byte_jump</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/ber.htm">ber_data and ber_skip</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/ssl.htm">ssl_state and ssl_version</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/dce.htm">DCE Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/sip.htm">SIP Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/sd_pattern.htm">sd_pattern</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/cvs.htm">cvs</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/hash.htm">md5, sha256, and sha512</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/gtp.htm">GTP Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/dnp3.htm">DNP3 Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/cip.htm">CIP Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/iec104.htm">IEC 104 Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/mms.htm">MMS Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/modbus.htm">Modbus Specific Options</a></li><li class="chapter-item expanded "><a href="../rules/options/payload/s7commplus.htm">S7CommPlus Specific Options</a></li></ol></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/index.htm">Non-Payload Detection Rule Options</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/options/non_payload/fragoffset.htm">fragoffset</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/ttl.htm">ttl</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/tos.htm">tos</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/id.htm">id</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/ipopts.htm">ipopts</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/fragbits.htm">fragbits</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/ip_proto.htm">ip_proto</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/flags.htm">flags</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/flow.htm">flow</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/flowbits.htm">flowbits</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/file_type.htm">file_type</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/seq.htm">seq</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/ack.htm">ack</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/window.htm">window</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/itype.htm">itype</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/icode.htm">icode</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/icmp_id.htm">icmp_id</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/icmp_seq.htm">icmp_seq</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/rpc.htm">rpc</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/stream_reassemble.htm">stream_reassemble</a></li><li class="chapter-item expanded "><a href="../rules/options/non_payload/stream_size.htm">stream_size</a></li></ol></li><li class="chapter-item expanded "><a href="../rules/options/post/index.htm">Post-Detection Rule Options</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rules/options/post/detection_filter.htm">detection_filter</a></li><li class="chapter-item expanded "><a href="../rules/options/post/replace.htm">replace</a></li><li class="chapter-item expanded "><a href="../rules/options/post/tag.htm">tag</a></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">Miscellaneous Information</li><li class="chapter-item expanded "><a href="../misc/shared-object-rules.htm">Shared Object Rules</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="snort-light">Snort Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="snort-dark">Snort Dark</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Snort 3 Rule Writing Guide</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.htm" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="snort-rules"><a class="header" href="#snort-rules">Snort Rules</a></h1>
<p>At its core, Snort is an intrusion detection system (IDS) and an intrusion prevention system (IPS), which means that it has the capability to detect intrusions on a network, and also prevent them. A configuration tells Snort how to process network traffic. It is the <em>rules</em> that determine whether Snort acts on a particular packet.</p>
<p>Snort rules can be placed directly in one's Lua configuration file(s) via the <code>ips</code> module, but for the most part they will live in distinct <code>.rules</code> files that get &quot;included&quot;. For example, say we had a <code>malware.rules</code> file in the same directory as our Lua configuration file. We could &quot;include&quot; that rules file like so: </p>
<pre><code class="language-lua">ips = { include = 'malware.rules' }
</code></pre>
<p>If users want to include multiple <code>.rules</code> files, then they can do so like:</p>
<pre><code class="language-lua">ips = 
{
    rules = [[
        include /path/to/rulesfile1.rules
        include /path/to/rulesfile2.rules
        …
    ]]
}
</code></pre>
<p>Alternatively, a single rules file or a path to a rules directory can be passed directly to Snort on the command line. This is done either with the <code>-R</code> option for a single rules file or the <code>--rule-path</code> option to pass in a whole directory of rules files. This is convenient for when you need to verify or troubleshoot a rule or rules against a pcap.</p>
<p>For example, the below command will run all the rules present in <code>malware.rules</code> against the traffic in <code>bad.pcap</code>:</p>
<pre><code>$ snort -c $my_path/lua/snort.lua -R malware.rules -r bad.pcap
</code></pre>
<h2 id="generating-alerts"><a class="header" href="#generating-alerts">Generating Alerts</a></h2>
<p>The above command by default will output various statistics about the particular run. These include details about any identified applications, any detection events, types of services detected, and much more. The detection events will show <em>how many</em> alerts fired on the provided traffic, but sometimes we want to know more than that. </p>
<p>Snort provides a few different &quot;alert mode&quot; options that can be set on the command line to tweak the way alerts are displayed. These modes include <code>cmg</code> which displays alerts alongside a hexdump of the alerting packet(s), as well as a few different <code>alert_*</code> modes shown below:</p>
<pre><code>$ snort --help-modules | grep alert
alert_csv (logger): output event in csv format
alert_fast (logger): output event with brief text format
alert_full (logger): output event with full packet dump
alert_json (logger): output event in json format
alert_syslog (logger): output event to syslog
alert_talos (logger): output event in Talos alert format
alert_unixsock (logger): output event over unix socket
alerts (basic): configure alerts
</code></pre>
<p>These modes are set with the <code>-A</code> option followed by the desired alert mode, and we can focus solely on the alerts by also including the <code>-q</code> (quiet) flag. The <code>cmg</code> alert mode, for example, will look something like: </p>
<pre><code>$ snort -q -c $my_path/lua/snort.lua -q -r get.pcap -R local.rules -A cmg
10/14-14:59:14.186063 [**] [1:0:0] &quot;GET request&quot; [**] [Classification: Web Application Attack] [Priority: 1] {TCP} 10.1.2.3:50284 -&gt; 10.9.8.7:80

http_inspect.http_method[3]:
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -
47 45 54                                          GET
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -

http_inspect.http_version[8]:
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -
48 54 54 50 2F 31 2E 31                           HTTP/1.1
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -

http_inspect.http_uri[6]:
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -
2F 68 65 6C 6C 6F                                 /hello
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -

http_inspect.http_header[78]:
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -
48 6F 73 74 3A 20 61 62  63 69 70 2D 68 6F 73 74  Host: ab cip-host
2E 6C 6F 63 61 6C 0D 0A  55 73 65 72 2D 41 67 65  .local.. User-Age
6E 74 3A 20 61 62 63 69  70 0D 0A 41 63 63 65 70  nt: abci p..Accep
74 2D 4C 61 6E 67 75 61  67 65 3A 20 65 6E 2D 75  t-Langua ge: en-u
73 0D 0A 41 63 63 65 70  74 3A 20 2A 2F 2A        s..Accep t: */*
- - - - - - - - - - - -  - - - - - - - - - - - -  - - - - - - - - -
</code></pre>
<p>The <code>alert_talos</code> is another useful mode that displays alerts in a format that is simple and easy-to-understand.</p>
<pre><code>$ snort -q -c $my_path/lua/snort.lua -q -r get.pcap -R local.rules -A alert_talos

##### get.pcap #####
        [1:0:0] GET request (alerts: 1)
#####
</code></pre>
<p>Lastly, Some of the <code>alert_*</code> modes are customizable. <code>alert_csv</code> for example allows for customization of the different &quot;fields&quot; that can be outputted. The following example demonstrates a custom CSV alert configuration using the <code>--lua</code> command line flag:</p>
<pre><code>$ snort -q -c $my_path/lua/snort/lua -r cmd_injection.pcap -R local.rules --lua 'alert_csv = { fields = &quot;action pkt_num gid sid rev msg service src_addr src_port dst_addr dst_port&quot;, separator = &quot;,&quot; }'
would_block,5,1,1000000,0,&quot;Command injection detected&quot;,http,10.1.2.3,50284,10.9.8.7,80
would_block,6,1,1000000,0,&quot;Command injection detected&quot;,http,10.1.2.3,50284,10.9.8.7,80
</code></pre>
<h2 id="testing-rules-inline"><a class="header" href="#testing-rules-inline">Testing Rules Inline</a></h2>
<p>To protect networks, it's also important to make sure that our rules are blocking attacks appropriately, and the <code>dump</code> DAQ enables us to do just that.</p>
<p>Specifying the <code>-Q</code> option to enable inline mode and then setting the <code>--daq</code> to <code>dump</code> will &quot;dump&quot; the traffic that would've been passed through, emulating a real inline operation. The resulting traffic will be dumped, by default, to a file named <code>inline-out.pcap</code>:</p>
<pre><code>$ snort3 -Q --daq dump -q -r get.pcap -R local.rules
</code></pre>
<p>In the above example, if the <code>local.rules</code> file contains a <code>block</code> rule that fires on some traffic in the <code>get.pcap</code> file, then the resulting <code>inline-out.pcap</code> file will contain only the traffic that was not blocked. We can use this functionality to test that our rules are preventing the actual attack packet(s) from getting through.</p>
<h2 id="converting-snort-2-rules-to-snort-3"><a class="header" href="#converting-snort-2-rules-to-snort-3">Converting Snort 2 Rules to Snort 3</a></h2>
<p>Lastly, just like with configuration files, <code>snort2lua</code> can also be used to convert old Snort 2 rules to Snort 3 ones. Pass the Snort 2 rules file to the <code>-c</code> option and then provide a filename for the new Snort 3 rules file to the <code>-r</code> option:</p>
<pre><code>$ snort2lua -c in.rules -r out.rules
</code></pre>
<p>Note that if any errors occur during the conversion, <code>snort2lua</code> will output a <code>snort.rej</code> file that explains what went wrong:</p>
<pre><code>$ snort2lua -c 2.rules -r 3.rules
ERROR: 1 errors occurred while converting
ERROR: see snort.rej for details
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="configuration.htm" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="wizard_binder.htm" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="configuration.htm" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="wizard_binder.htm" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        
        

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    <script defer="" src="../beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon='{"rayId":"847db0f78d2ed97b","b":1,"version":"2024.1.0","token":"259dc4eadf5b43fbbc95b1d26ba39d7c"}' crossorigin="anonymous"></script>
</body>
</html>
