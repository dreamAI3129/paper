"use strict";document.addEventListener("DOMContentLoaded",function(){function verifyNames(formElement){var fields=[formElement.querySelector("input[name=\"firstname\"]"),formElement.querySelector("input[name=\"lastname\"]")],valid=!0;return fields=fields.filter(function(field){return!!field}),fields.forEach(function(field){2>field.value.length&&(showFieldError($(field),"Invalid entry. Please use a minimum of 2 letters."),valid=!1)}),valid}function verifyEmailHandler(formElement,cb){var $form=$(formElement),$emailField=$form.find("input[type=\"email\"]"),emailAddress=$emailField.val();return verifyEmail(emailAddress).then(function(_ref){var valid=_ref.valid,error=_ref.error;if(error&&(console.log("Can't verify the email, submitting the form. (don't block leads)"),console.error(error)),!valid)throw new Error("Please enter your business email address.")}).then(function(){return cb()})["catch"](function(err){return showFieldError($emailField,err.message),!1}),!1}function showFieldError($field,message){var $errorMessage=$("<ul class=\"no-list hs-error-msgs inputs-list custom-validation-error\" role=\"alert\"><li><label class=\"hs-error-msg\">".concat(message,"</label></li></ul>"));$field.closest(".hs-form-field").append($errorMessage),fieldsErrorsListeners.get($field[0])||($field.on("change",function(){return removeOldValidationErrorMessage($field)}),fieldsErrorsListeners.set($field[0],!0),console.log($field))}function removeOldValidationErrorMessage($field){$field.closest(".hs-form-field").find(".hs-error-msgs.custom-validation-error").remove()}function verifyEmail(email){return fetch("/wp-json/verify/v1/email/".concat(email)).then(function(response){return response.json()})["catch"](function(error){return{valid:!0,error:error}})}var $=window.jQuery,fieldsErrorsListeners=new Map;window.addEventListener("message",function(event){if("hsFormCallback"===event.data.type&&"onFormReady"===event.data.eventName){var $form=$(".hs-form-"+event.data.id);$form.each(function(){var $parent=$(this).parent();$parent.hasClass("emailVerificationSet")||(this.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation()},!1),this.addEventListener("submit",function(submitEvent){submitEvent.preventDefault(),submitEvent.stopPropagation();var formElement=submitEvent.target;return $(formElement).find(".hs-error-msgs.custom-validation-error").remove(),verifyNames(formElement)&&verifyEmailHandler(formElement,function(){return formElement.submit()}),!1},!0),$parent.addClass("emailVerificationSet"))})}})})